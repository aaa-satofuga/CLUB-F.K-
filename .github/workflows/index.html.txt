<!doctype html>
<html lang="ja">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Host Club</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&family=Bebas+Neue&family=Roboto+Condensed:wght@300;400;700;900&display=swap');

    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Roboto Condensed', 'Arial Narrow', sans-serif;
      background: #000000;
      color: #ffffff;
      overflow-x: hidden;
      width: 100%;
      height: 100%;
      letter-spacing: 0.5px;
    }

    * {
      box-sizing: border-box;
    }

    html {
      height: 100%;
    }

    /* Background */
    .bg-stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      background: radial-gradient(ellipse at center, #1a0033 0%, #000000 100%);
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 1s ease-in-out infinite;
    }

    @keyframes twinkle {
      0%, 100% { 
        opacity: 0.2;
        transform: scale(0.8);
        box-shadow: 0 0 2px rgba(255, 255, 255, 0.3);
      }
      50% { 
        opacity: 1;
        transform: scale(1.2);
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.9), 0 0 12px rgba(255, 255, 255, 0.6);
      }
    }



    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 25px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 215, 0, 0.3);
    }

    .logo {
      font-size: 42px;
      font-weight: 700;
      font-family: 'Bebas Neue', 'Impact', sans-serif;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: 6px;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
      user-select: none;
    }

    .hamburger {
      width: 40px;
      height: 40px;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      cursor: pointer;
      z-index: 1001;
    }

    .hamburger span {
      width: 100%;
      height: 3px;
      background: #ffd700;
      border-radius: 3px;
      transition: all 0.3s ease;
    }

    .hamburger.edit-active span {
      background: #ff4757;
      box-shadow: 0 0 10px rgba(255, 71, 87, 0.5);
    }

    /* Menu Overlay */
    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1001;
      display: none;
      transition: opacity 0.3s ease;
    }

    .menu-overlay.open {
      display: block;
    }

    /* Side Menu */
    .side-menu {
      position: fixed;
      top: 0;
      right: -300px;
      width: 300px;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      border-left: 2px solid rgba(255, 215, 0, 0.3);
      z-index: 1002;
      transition: right 0.3s ease;
      overflow-y: auto;
      padding: 100px 30px 30px 30px;
    }

    .side-menu.open {
      right: 0;
    }

    .menu-item {
      color: #ffd700;
      text-decoration: none;
      font-size: 18px;
      font-weight: 600;
      padding: 15px 0;
      display: block;
      border-bottom: 1px solid rgba(255, 215, 0, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .menu-item:hover {
      color: #fff;
      padding-left: 10px;
    }

    /* Main */
    .main {
      position: relative;
      z-index: 1;
      padding-top: 100px;
      width: 100%;
    }

    /* Hero */
    .hero {
      width: 100%;
      min-height: 600px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 80px 20px 40px 20px;
    }

    .hero-title {
      font-size: 128px;
      font-weight: 400;
      font-family: 'Bebas Neue', 'Impact', sans-serif;
      margin-bottom: 0px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: 12px;
      text-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
      animation: titlePulse 3s ease-in-out infinite;
    }

    @keyframes titlePulse {
      0%, 100% { 
        text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        transform: scale(1);
      }
      50% { 
        text-shadow: 0 0 60px rgba(255, 215, 0, 0.6);
        transform: scale(1.02);
      }
    }

    .hero-subtitle {
      font-size: 28px;
      color: #fff;
      margin-bottom: 40px;
    }

    /* Showcase Section */
    .showcase-section {
      padding: 0 40px 80px 40px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .showcase-grid {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 15px;
      flex-wrap: nowrap;
      overflow-x: auto;
    }

    .showcase-item {
      position: relative;
      background: rgba(255, 255, 255, 0.03);
      border: 2px solid rgba(255, 215, 0, 0.2);
      border-radius: 15px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .showcase-item:hover {
      border-color: rgba(255, 215, 0, 0.6);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
      transform: translateY(-10px);
    }

    .showcase-image-container {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    .showcase-image-container img {
      position: absolute;
      object-fit: cover;
    }



    .showcase-add {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      color: #ffd700;
      background: rgba(255, 215, 0, 0.05);
      border: 2px dashed rgba(255, 215, 0, 0.3);
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .showcase-add:hover {
      background: rgba(255, 215, 0, 0.1);
      border-color: rgba(255, 215, 0, 0.6);
    }

    .showcase-controls {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 4px;
      background: rgba(0, 0, 0, 0.8);
      padding: 6px;
      border-radius: 20px;
      z-index: 10;
    }

    .showcase-btn {
      width: 28px;
      height: 28px;
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      border: none;
      border-radius: 50%;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      font-weight: bold;
    }

    .showcase-btn:hover {
      background: #ffd700;
      transform: scale(1.1);
    }

    .showcase-btn:active {
      transform: scale(0.95);
    }

    /* Section */
    .section {
      padding: 80px 40px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .section-title {
      font-size: 56px;
      font-weight: 400;
      font-family: 'Bebas Neue', 'Impact', sans-serif;
      text-align: center;
      margin-bottom: 60px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
      padding-bottom: 20px;
      letter-spacing: 6px;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 4px;
      background: linear-gradient(90deg, transparent, #ffd700, transparent);
    }

    /* Grid */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    /* News and Album Grid - Always 2x2 */
    .news-album-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 30px;
      margin-bottom: 40px;
    }

    /* Square Card for News and Album */
    .square-card {
      position: relative;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 20px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      padding-bottom: 100%; /* 1:1 aspect ratio */
    }

    .square-card:hover {
      transform: translateY(-10px);
      border-color: rgba(255, 215, 0, 0.6);
      box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
    }

    .square-card-inner {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .card {
      position: relative;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 20px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-10px);
      border-color: rgba(255, 215, 0, 0.6);
      box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
    }

    .card-image-container {
      width: 100%;
      padding-bottom: 128.57%;
      position: relative;
      overflow: hidden;
      background: #111;
    }
    
    .card-image-container-inner {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .card-image {
      position: absolute;
      object-fit: cover;
    }

    .card-image-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 20px;
      background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
    }

    .card-date {
      font-size: 12px;
      color: #ffd700;
      margin-bottom: 5px;
    }

    .card-overlay-title {
      font-size: 24px;
      font-weight: 700;
      font-family: 'Oswald', sans-serif;
      color: #fff;
      letter-spacing: 2px;
    }

    .card-body {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 25px;
      background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
      text-align: center;
    }

    .card-title {
      font-size: clamp(16px, 5vw, 28px);
      font-weight: 700;
      font-family: 'Oswald', 'Arial Narrow', sans-serif;
      color: #ffd700;
      margin-bottom: 8px;
      letter-spacing: 2px;
      text-transform: uppercase;
      line-height: 1.2;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: clip;
    }

    .card-text {
      font-size: 14px;
      color: #aaa;
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-top: 40px;
    }

    .pagination-btn {
      padding: 12px 30px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .pagination-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
    }

    .pagination-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .pagination-info {
      font-size: 16px;
      color: #ffd700;
    }

    /* Add Button */
    .add-btn {
      display: block;
      margin: 0 auto;
      padding: 18px 50px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
      border: none;
      border-radius: 50px;
      font-size: 20px;
      font-weight: 700;
      font-family: 'Oswald', 'Arial Narrow', sans-serif;
      letter-spacing: 2px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
    }

    .add-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
    }

    .add-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Edit Button on Card */
    .edit-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 50px;
      height: 50px;
      background: rgba(255, 215, 0, 0.95);
      color: #000;
      border: none;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    .edit-btn:hover {
      transform: scale(1.15);
      box-shadow: 0 6px 15px rgba(255, 215, 0, 0.6);
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 5000;
      overflow-y: auto;
      padding: 40px 20px;
    }

    .modal.show {
      display: block;
    }

    .modal-content {
      max-width: 700px;
      margin: 0 auto;
      background: #000;
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 20px;
      padding: 50px;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 36px;
      color: #ffd700;
      cursor: pointer;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(255, 215, 0, 0.1);
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: rgba(255, 215, 0, 0.3);
      transform: rotate(90deg);
    }

    .modal-title {
      font-size: 38px;
      font-weight: 400;
      font-family: 'Bebas Neue', 'Impact', sans-serif;
      color: #ffd700;
      margin-bottom: 30px;
      text-align: center;
      letter-spacing: 4px;
    }

    /* Cast Detail Modal */
    .cast-detail-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 4000;
      display: none;
      overflow-y: auto;
      padding: 120px 20px 40px 20px;
    }

    .cast-detail-overlay.show {
      display: block;
    }

    .cast-detail {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.95);
      border-radius: 20px;
      padding: 50px;
      position: relative;
    }

    .cast-detail-header {
      display: flex;
      gap: 30px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .cast-detail-image-container {
      position: relative;
      width: 350px;
      height: 450px;
      border-radius: 15px;
      overflow: hidden;
      border: 2px solid rgba(255, 215, 0, 0.3);
      flex-shrink: 0;
    }

    .cast-detail-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      user-select: none;
    }

    .cast-detail-info {
      flex: 1;
      min-width: 250px;
    }

    .cast-detail-name {
      font-size: 42px;
      font-weight: 700;
      font-family: 'Bebas Neue', sans-serif;
      color: #ffd700;
      margin-bottom: 20px;
      letter-spacing: 3px;
      text-align: center;
    }

    .cast-detail-field {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .cast-detail-label {
      font-size: 14px;
      color: #888;
      min-width: 70px;
    }

    .cast-detail-value {
      font-size: 18px;
      color: #fff;
      flex: 1;
    }
    
    .cast-detail-fields-row {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .cast-detail-value input {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 5px;
      color: #fff;
      padding: 5px 10px;
      font-size: 16px;
      font-family: inherit;
    }

    .cast-detail-sns {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .sns-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .sns-icon:hover {
      transform: scale(1.2);
    }

    .sns-instagram {
      background: linear-gradient(135deg, #833ab4, #fd1d1d, #fcb045);
      color: #fff;
    }

    .sns-tiktok {
      background: #000;
      color: #fff;
      border: 2px solid #00f2ea;
    }

    .sns-x {
      background: #000;
      color: #fff;
      border: 2px solid #1da1f2;
    }

    .sns-hoshos {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
    }

    .cast-detail-bio {
      margin-top: 30px;
      padding: 20px;
      background: rgba(255, 215, 0, 0.05);
      border-radius: 10px;
      line-height: 1.8;
    }

    .cast-detail-gallery {
      margin-top: 40px;
    }

    .cast-detail-gallery-title {
      font-size: 28px;
      font-family: 'Bebas Neue', sans-serif;
      color: #ffd700;
      margin-bottom: 20px;
      letter-spacing: 2px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }

    .gallery-item {
      position: relative;
      width: 100%;
      padding-bottom: 100%;
      border-radius: 10px;
      overflow: hidden;
      border: 2px solid rgba(255, 215, 0, 0.2);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .gallery-item:hover {
      border-color: rgba(255, 215, 0, 0.6);
      transform: scale(1.05);
    }

    .gallery-item-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .gallery-add {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      color: #ffd700;
      background: rgba(255, 215, 0, 0.05);
      border: 2px dashed rgba(255, 215, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .gallery-add:hover {
      background: rgba(255, 215, 0, 0.1);
    }

    .gallery-controls {
      position: absolute;
      top: 5px;
      right: 5px;
      display: flex;
      gap: 3px;
      z-index: 10;
    }

    .gallery-btn {
      width: 30px;
      height: 30px;
      background: rgba(255, 215, 0, 0.95);
      color: #000;
      border: none;
      border-radius: 50%;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .gallery-btn:hover {
      transform: scale(1.1);
    }

    .card-zoom-controls {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 4px;
      background: rgba(0, 0, 0, 0.8);
      padding: 6px;
      border-radius: 20px;
      z-index: 11;
    }

    .card-zoom-btn {
      width: 28px;
      height: 28px;
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      border: none;
      border-radius: 50%;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      font-weight: bold;
    }

    .card-zoom-btn:hover {
      background: #ffd700;
      transform: scale(1.1);
    }

    .card-zoom-btn:active {
      transform: scale(0.95);
    }

    /* Gallery Lightbox */
    .gallery-lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 6000;
      overflow-y: auto;
      padding: 100px 20px 40px 20px;
    }

    .gallery-lightbox.show {
      display: block;
    }

    .gallery-lightbox-content {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .gallery-lightbox-image {
      width: 100%;
      border-radius: 15px;
      border: 2px solid rgba(255, 215, 0, 0.3);
    }



    /* Form */
    .form-group {
      margin-bottom: 25px;
    }

    .form-label {
      display: block;
      color: #ffd700;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 15px;
    }

    .form-input,
    .form-textarea {
      width: 100%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 10px;
      color: #fff;
      font-size: 15px;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .form-input:focus,
    .form-textarea:focus {
      outline: none;
      border-color: #ffd700;
      background: rgba(255, 255, 255, 0.08);
    }

    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }

    .form-row {
      display: flex;
      gap: 15px;
    }

    .form-row .form-group {
      flex: 1;
    }

    .form-buttons {
      display: flex;
      gap: 15px;
      margin-top: 35px;
    }

    .form-btn {
      flex: 1;
      padding: 18px;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .form-btn-submit {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
    }

    .form-btn-cancel {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .form-btn-delete {
      background: linear-gradient(135deg, #ff4757, #ff6b81);
      color: #fff;
    }

    .form-btn:hover {
      transform: translateY(-2px);
    }

    .form-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Password Modal */
    .password-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 6000;
      align-items: center;
      justify-content: center;
    }

    .password-modal.show {
      display: flex;
    }

    .password-box {
      background: #000;
      border: 2px solid rgba(255, 215, 0, 0.5);
      border-radius: 20px;
      padding: 50px;
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .password-title {
      font-size: 32px;
      font-weight: 400;
      font-family: 'Bebas Neue', 'Impact', sans-serif;
      color: #ffd700;
      margin-bottom: 30px;
      letter-spacing: 3px;
    }

    .password-input {
      width: 100%;
      padding: 18px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 10px;
      color: #fff;
      font-size: 24px;
      font-family: inherit;
      text-align: center;
      letter-spacing: 8px;
      margin-bottom: 10px;
    }

    .password-input:focus {
      outline: none;
      border-color: #ffd700;
      background: rgba(255, 255, 255, 0.08);
    }

    .password-error {
      color: #ff4757;
      font-size: 14px;
      margin-bottom: 20px;
      min-height: 20px;
    }

    .password-buttons {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }

    .password-btn {
      flex: 1;
      padding: 15px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .password-btn-submit {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
    }

    .password-btn-cancel {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .password-btn:hover {
      transform: translateY(-2px);
    }

    /* Toast */
    .toast {
      position: fixed;
      top: 120px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 215, 0, 0.95);
      color: #000;
      padding: 18px 40px;
      border-radius: 50px;
      font-weight: bold;
      z-index: 10000;
      box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    /* Store/Price/Recruit Section */
    .info-section {
      background: rgba(255, 215, 0, 0.05);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 30px;
      position: relative;
    }

    .info-section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .info-section-title {
      font-size: 28px;
      font-weight: 700;
      font-family: 'Oswald', sans-serif;
      color: #ffd700;
      letter-spacing: 2px;
    }

    .info-section-content {
      line-height: 2;
      font-size: 16px;
      white-space: pre-wrap;
    }

    .info-edit-btn {
      width: 40px;
      height: 40px;
      background: rgba(255, 215, 0, 0.95);
      color: #000;
      border: none;
      border-radius: 50%;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .info-edit-btn:hover {
      transform: scale(1.1);
    }

    .address-section {
      background: rgba(255, 215, 0, 0.05);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      position: relative;
    }

    .address-content {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .address-text {
      font-size: 18px;
      color: #fff;
      line-height: 1.8;
    }

    .map-btn {
      display: inline-block;
      padding: 15px 40px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      text-align: center;
    }

    .map-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
    }

    .sns-section {
      background: rgba(255, 215, 0, 0.05);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
    }

    .sns-section-title {
      font-size: 24px;
      font-weight: 700;
      font-family: 'Oswald', sans-serif;
      color: #ffd700;
      margin-bottom: 20px;
      text-align: center;
      letter-spacing: 2px;
    }

    .sns-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .sns-link-btn {
      padding: 15px 40px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      display: inline-block;
    }

    .sns-link-btn:hover {
      transform: translateY(-3px) scale(1.05);
    }

    .sns-instagram-btn {
      background: linear-gradient(135deg, #833ab4, #fd1d1d, #fcb045);
      color: #fff;
    }

    .sns-hoshos-btn {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
    }

    .recruit-link-section {
      text-align: center;
      margin-top: 30px;
    }

    .recruit-detail-btn {
      display: inline-block;
      padding: 18px 50px;
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #000;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 700;
      font-size: 18px;
      transition: all 0.3s ease;
      letter-spacing: 1px;
    }

    .recruit-detail-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
    }

    .recruit-contact {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 30px;
    }

    .contact-btn {
      padding: 15px 40px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      display: inline-block;
    }

    .contact-btn:hover {
      transform: translateY(-3px) scale(1.05);
    }

    .contact-line {
      background: linear-gradient(135deg, #00B900, #00E600);
      color: #fff;
    }

    .contact-tel {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
    }

    /* Unified mobile-first design for all screen sizes */
    .hero-title {
      font-size: 48px;
    }

    .section-title {
      font-size: 36px;
    }

    .grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
    }

    #castGrid {
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
    }

    .showcase-grid {
      flex-direction: row;
    }

    .cast-detail-header {
      flex-direction: column;
    }

    .cast-detail-image-container {
      width: 100%;
      max-width: 350px;
      margin: 0 auto;
    }

    .header {
      padding: 20px 20px;
    }

    .logo {
      font-size: 32px;
      letter-spacing: 4px;
    }

    .hero {
      min-height: 400px;
      padding: 60px 20px 40px 20px;
    }

    .hero-subtitle {
      font-size: 20px;
    }

    .section {
      padding: 60px 20px;
    }

    .showcase-section {
      padding: 0 20px 60px 20px;
    }

    .modal-content {
      padding: 30px 20px;
      margin: 0 10px;
    }

    .cast-detail {
      padding: 30px 20px;
      margin: 0 10px;
    }

    .form-row {
      flex-direction: column;
      gap: 0;
    }

    .cast-move-controls {
      position: absolute;
      top: 10px;
      left: 10px;
      display: grid;
      grid-template-columns: repeat(3, 32px);
      grid-template-rows: repeat(3, 32px);
      gap: 4px;
      background: rgba(0, 0, 0, 0.8);
      padding: 6px;
      border-radius: 12px;
      z-index: 10;
    }

    .cast-move-btn {
      width: 32px;
      height: 32px;
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      font-weight: bold;
    }

    .cast-move-btn:hover {
      background: #ffd700;
      transform: scale(1.1);
    }

    .cast-move-btn:active {
      transform: scale(0.95);
    }

    @media (min-width: 768px) {
      .hero-title {
        font-size: 128px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Background Stars -->
  <div class="bg-stars" id="bgStars"></div><!-- Header -->
  <header class="header">
   <div class="logo" id="clubName">
    CLUB F.K
   </div>
   <div class="hamburger" id="hamburger"><span></span> <span></span> <span></span>
   </div>
  </header><!-- Menu Overlay -->
  <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div><!-- Side Menu -->
  <nav class="side-menu" id="sideMenu">
   <div class="modal-close" onclick="closeMenu()" style="position: absolute; top: 20px; right: 20px; z-index: 10;">
    √ó
   </div><a class="menu-item" onclick="scrollToSection('cast')">üë§ „Ç≠„É£„Çπ„Éà</a> <a class="menu-item" onclick="scrollToSection('news')">üì∞ „Éã„É•„Éº„Çπ</a> <a class="menu-item" onclick="scrollToSection('album')">üì∑ „Ç¢„É´„Éê„É†</a> <a class="menu-item" onclick="scrollToSection('store')">ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ Â∫óËàóÁ¥π‰ªã</a> <a class="menu-item" onclick="scrollToSection('price')">üí∞ ÊñôÈáë„Ç∑„Çπ„ÉÜ„É†</a> <a class="menu-item" onclick="scrollToSection('recruit')">üíº Ê±Ç‰∫∫ÂãüÈõÜ</a>
  </nav><!-- Main -->
  <main class="main"><!-- Hero -->
   <section class="hero">
    <div>
     <h1 class="hero-title" id="heroTitle">CLUB F.K</h1>
     <p class="hero-subtitle" id="heroSubtitle">ÊúÄÈ´ò„Å™ÊôÇÈñì„ÇíË≤¥Êñπ„Å®ÂÖ±„Å´</p>
    </div>
   </section><!-- Showcase Section -->
   <section class="showcase-section">
    <div class="showcase-grid" id="showcaseGrid"></div>
   </section><!-- Cast -->
   <section class="section" id="cast">
    <h2 class="section-title">„Ç≠„É£„Çπ„ÉàÁ¥π‰ªã</h2>
    <div class="grid" id="castGrid"></div><button class="add-btn" id="addCast" style="display: none;">+ „Ç≠„É£„Çπ„Éà„ÇíÔøΩÔøΩÔøΩÂä†</button>
   </section><!-- News -->
   <section class="section" id="news">
    <h2 class="section-title">„Éã„É•„Éº„Çπ</h2>
    <div class="news-album-grid" id="newsGrid"></div>
    <div class="pagination" id="newsPagination" style="display: none;"><button class="pagination-btn" id="newsPrev">Ââç</button> <span class="pagination-info" id="newsPageInfo"></span> <button class="pagination-btn" id="newsNext">Âæå</button>
    </div><button class="add-btn" id="addNews" style="display: none;">+ „Éã„É•„Éº„Çπ„ÇíËøΩÂä†</button>
   </section><!-- Album -->
   <section class="section" id="album">
    <h2 class="section-title">„Ç¢„É´„Éê„É†</h2>
    <div class="news-album-grid" id="albumGrid"></div>
    <div class="pagination" id="albumPagination" style="display: none;"><button class="pagination-btn" id="albumPrev">Ââç</button> <span class="pagination-info" id="albumPageInfo"></span> <button class="pagination-btn" id="albumNext">Âæå</button>
    </div><button class="add-btn" id="addAlbum" style="display: none;">+ „Ç¢„É´„Éê„É†„ÇíËøΩÂä†</button>
   </section><!-- Store -->
   <section class="section" id="store">
    <h2 class="section-title">Â∫óËàóÁ¥π‰ªã</h2>
    <div id="storeContent"></div><button class="add-btn" id="addStore" style="display: none;">+ È†ÖÁõÆ„ÇíËøΩÂä†</button>
   </section><!-- Price -->
   <section class="section" id="price">
    <h2 class="section-title">ÊñôÈáë„Ç∑„Çπ„ÉÜ„É†</h2>
    <div id="priceContent"></div><button class="add-btn" id="addPrice" style="display: none;">+ È†ÖÁõÆ„ÇíËøΩÂä†</button>
   </section><!-- Recruit -->
   <section class="section" id="recruit">
    <h2 class="section-title">Ê±Ç‰∫∫ÂãüÈõÜ</h2>
    <div id="recruitContent"></div><button class="add-btn" id="addRecruit" style="display: none;">+ È†ÖÁõÆ„ÇíËøΩÂä†</button>
   </section>
  </main><!-- Cast Detail Modal -->
  <div class="cast-detail-overlay" id="castDetail">
   <div class="cast-detail">
    <div class="modal-close" onclick="closeCastDetail()">
     √ó
    </div>
    <div id="castDetailContent"></div>
   </div>
  </div><!-- Gallery Lightbox -->
  <div class="gallery-lightbox" id="galleryLightbox">
   <div class="modal-close" onclick="closeGalleryLightbox()" style="position: fixed; top: 20px; right: 20px;">
    √ó
   </div>
   <div class="gallery-lightbox-content" id="galleryLightboxContent"></div>
  </div><!-- Password Modal -->
  <div class="password-modal" id="passwordModal">
   <div class="password-box">
    <div class="password-title">
     „Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ
    </div>
    <form id="passwordForm"><input type="password" class="password-input" id="passwordInput" placeholder="***" maxlength="3" required>
     <div class="password-error" id="passwordError"></div>
     <div class="password-buttons"><button type="submit" class="password-btn password-btn-submit">Á¢∫Ë™ç</button> <button type="button" class="password-btn password-btn-cancel" onclick="closePasswordModal()">„Ç≠„É£„É≥„Çª„É´</button>
     </div>
    </form>
   </div>
  </div><!-- Form Modal -->
  <div class="modal" id="formModal">
   <div class="modal-content">
    <div class="modal-close" onclick="closeModal()">
     √ó
    </div>
    <div class="modal-title" id="formTitle">
     ËøΩÂä†
    </div>
    <form id="dataForm">
     <div id="formFields"></div>
     <div class="form-buttons" id="formButtons"><button type="submit" class="form-btn form-btn-submit" id="submitBtn">‰øùÂ≠ò</button> <button type="button" class="form-btn form-btn-cancel" onclick="closeModal()">„Ç≠„É£„É≥„Çª„É´</button>
     </div>
    </form>
   </div>
  </div>
  <script>
    // State
    let allData = [];
    let editMode = false;
    let currentEdit = null;
    let currentType = null;
    let currentCast = null;
    let currentGalleryIndex = null;
    let currentShowcaseIndex = null;
    let newsPage = 0;
    let albumPage = 0;

    // Config
    const defaultConfig = {
      club_name: 'CLUB F.K',
      club_tagline: 'ÊúÄÈ´ò„Å™ÊôÇÈñì„ÇíË≤¥Êñπ„Å®ÂÖ±„Å´'
    };

    let config = { ...defaultConfig };

    // Element SDK
    async function onConfigChange(newConfig) {
      config = { ...newConfig };
      const clubName = config.club_name || defaultConfig.club_name;
      const tagline = config.club_tagline || defaultConfig.club_tagline;
      
      document.getElementById('clubName').textContent = clubName;
      document.getElementById('heroTitle').textContent = clubName;
      document.getElementById('heroSubtitle').textContent = tagline;
    }

    function mapToCapabilities(cfg) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(cfg) {
      return new Map([
        ['club_name', cfg.club_name || defaultConfig.club_name],
        ['club_tagline', cfg.club_tagline || defaultConfig.club_tagline]
      ]);
    }

    // Data SDK Handler
    const dataHandler = {
      onDataChanged(data) {
        allData = data.sort((a, b) => (a.order || 0) - (b.order || 0));
        renderAll();
      }
    };

    // Initialize
    async function init() {
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
        config = window.elementSdk.config;
        await onConfigChange(config);
      }

      const result = await window.dataSdk.init(dataHandler);
      if (!result.isOk) {
        console.error('SDK initialization failed');
      }

      createStars();
      setupEvents();
    }

    // Create Stars
    function createStars() {
      const container = document.getElementById('bgStars');
      for (let i = 0; i < 200; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        const size = Math.random() * 3 + 1;
        star.style.width = size + 'px';
        star.style.height = size + 'px';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 3 + 's';
        container.appendChild(star);
      }
    }

    // Setup Events
    function setupEvents() {
      let pressTimer;
      const hamburger = document.getElementById('hamburger');
      
      // Mouse events
      hamburger.addEventListener('mousedown', () => {
        pressTimer = setTimeout(() => {
          toggleEdit();
        }, 800);
      });
      
      hamburger.addEventListener('mouseup', () => {
        clearTimeout(pressTimer);
      });
      
      hamburger.addEventListener('mouseleave', () => {
        clearTimeout(pressTimer);
      });
      
      hamburger.addEventListener('click', (e) => {
        if (!editMode) {
          toggleMenu();
        }
      });
      
      // Touch events
      hamburger.addEventListener('touchstart', (e) => {
        pressTimer = setTimeout(() => {
          toggleEdit();
        }, 800);
      });
      
      hamburger.addEventListener('touchend', () => {
        clearTimeout(pressTimer);
      });
      
      hamburger.addEventListener('touchcancel', () => {
        clearTimeout(pressTimer);
      });
      
      document.getElementById('addCast').onclick = () => openForm('cast');
      document.getElementById('addNews').onclick = () => openForm('news');
      document.getElementById('addAlbum').onclick = () => openForm('album');
      document.getElementById('addStore').onclick = () => openForm('store');
      document.getElementById('addPrice').onclick = () => openForm('price');
      document.getElementById('addRecruit').onclick = () => openForm('recruit');
      document.getElementById('dataForm').onsubmit = handleSubmit;
      document.getElementById('passwordForm').onsubmit = verifyPassword;
      
      // News pagination
      document.getElementById('newsPrev').onclick = () => {
        if (newsPage > 0) {
          newsPage--;
          renderNews();
        }
      };
      document.getElementById('newsNext').onclick = () => {
        const newsItems = allData.filter(d => d.type === 'news');
        if ((newsPage + 1) * 4 < newsItems.length) {
          newsPage++;
          renderNews();
        }
      };
      
      // Album pagination
      document.getElementById('albumPrev').onclick = () => {
        if (albumPage > 0) {
          albumPage--;
          renderAlbum();
        }
      };
      document.getElementById('albumNext').onclick = () => {
        const albumItems = allData.filter(d => d.type === 'album');
        if ((albumPage + 1) * 4 < albumItems.length) {
          albumPage++;
          renderAlbum();
        }
      };
    }

    // Toggle Menu
    function toggleMenu() {
      document.getElementById('sideMenu').classList.toggle('open');
      document.getElementById('menuOverlay').classList.toggle('open');
    }

    // Close Menu
    function closeMenu() {
      document.getElementById('sideMenu').classList.remove('open');
      document.getElementById('menuOverlay').classList.remove('open');
    }

    // Show Password Modal
    function showPasswordModal() {
      document.getElementById('passwordModal').classList.add('show');
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordError').textContent = '';
      document.getElementById('passwordInput').focus();
    }

    // Close Password Modal
    function closePasswordModal() {
      document.getElementById('passwordModal').classList.remove('show');
    }

    // Verify Password
    function verifyPassword(e) {
      e.preventDefault();
      const password = document.getElementById('passwordInput').value;
      const errorElement = document.getElementById('passwordError');
      
      if (password === '123') {
        closePasswordModal();
        activateEditMode();
      } else {
        errorElement.textContent = '„Éë„Çπ„ÉØ„Éº„Éâ„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åæ„Åô';
        document.getElementById('passwordInput').value = '';
        document.getElementById('passwordInput').focus();
      }
    }

    // Activate Edit Mode
    function activateEditMode() {
      editMode = true;
      const hamburger = document.getElementById('hamburger');
      hamburger.classList.add('edit-active');
      document.getElementById('addCast').style.display = 'block';
      document.getElementById('addNews').style.display = 'block';
      document.getElementById('addAlbum').style.display = 'block';
      document.getElementById('addStore').style.display = 'block';
      document.getElementById('addPrice').style.display = 'block';
      document.getElementById('addRecruit').style.display = 'block';
      showToast('‚úèÔ∏è Á∑®ÈõÜ„É¢„Éº„ÉâON');
      closeMenu();
      renderAll();
    }

    // Toggle Edit Mode
    function toggleEdit() {
      if (editMode) {
        // Turn off edit mode
        editMode = false;
        const hamburger = document.getElementById('hamburger');
        hamburger.classList.remove('edit-active');
        document.getElementById('addCast').style.display = 'none';
        document.getElementById('addNews').style.display = 'none';
        document.getElementById('addAlbum').style.display = 'none';
        document.getElementById('addStore').style.display = 'none';
        document.getElementById('addPrice').style.display = 'none';
        document.getElementById('addRecruit').style.display = 'none';
        showToast('‚úîÔ∏è Á∑®ÈõÜ„É¢„Éº„ÉâOFF');
        renderAll();
      } else {
        // Show password modal to turn on edit mode
        showPasswordModal();
      }
    }

    // Render All
    function renderAll() {
      renderShowcase();
      renderCast();
      renderNews();
      renderAlbum();
      renderStore();
      renderPrice();
      renderRecruit();
    }

    // Open Showcase Size Edit
    function openShowcaseSizeEdit(item, position) {
      const tempModal = document.createElement('div');
      tempModal.className = 'password-modal show';
      tempModal.innerHTML = `
        <div class="password-box" style="max-width: 500px;">
          <div class="password-title">„Çµ„Ç§„Ç∫Â§âÊõ¥</div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; color: #ffd700; margin-bottom: 10px; font-weight: 600; font-size: 15px;">ÂπÖ (px)</label>
            <input type="number" id="editWidth" value="${item.showcaseWidth || 100}" min="50" max="200" style="width: 100%; padding: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; color: #fff; font-size: 15px; font-family: inherit;">
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; color: #ffd700; margin-bottom: 10px; font-weight: 600; font-size: 15px;">È´ò„Åï (px)</label>
            <input type="number" id="editHeight" value="${item.showcaseHeight || 300}" min="200" max="500" style="width: 100%; padding: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; color: #fff; font-size: 15px; font-family: inherit;">
          </div>
          <div class="password-buttons">
            <button class="password-btn password-btn-submit" id="confirmSize">ÔøΩÔøΩÔøΩÂ≠ò</button>
            <button class="password-btn password-btn-cancel" id="cancelSize">„Ç≠„É£„É≥„Çª„É´</button>
          </div>
        </div>
      `;
      document.body.appendChild(tempModal);
      
      document.getElementById('confirmSize').onclick = async () => {
        const newWidth = parseInt(document.getElementById('editWidth').value);
        const newHeight = parseInt(document.getElementById('editHeight').value);
        
        await window.dataSdk.update({
          ...item,
          showcaseWidth: newWidth,
          showcaseHeight: newHeight
        });
        
        document.body.removeChild(tempModal);
        showToast('„Çµ„Ç§„Ç∫„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
      };
      
      document.getElementById('cancelSize').onclick = () => {
        document.body.removeChild(tempModal);
      };
    }

    // Move Showcase
    async function moveShowcase(item, direction) {
      const items = allData.filter(d => d.type === 'showcase').sort((a, b) => (a.showcasePosition || 0) - (b.showcasePosition || 0));
      const currentIndex = items.findIndex(i => i.__backendId === item.__backendId);
      
      if (currentIndex === -1) return;
      
      let targetIndex;
      if (direction === 'left' && currentIndex > 0) {
        targetIndex = currentIndex - 1;
      } else if (direction === 'right' && currentIndex < items.length - 1) {
        targetIndex = currentIndex + 1;
      } else {
        return;
      }
      
      const targetItem = items[targetIndex];
      const tempPosition = item.showcasePosition;
      
      await window.dataSdk.update({
        ...item,
        showcasePosition: targetItem.showcasePosition
      });
      
      await window.dataSdk.update({
        ...targetItem,
        showcasePosition: tempPosition
      });
    }

    // Render Showcase
    function renderShowcase() {
      const items = allData.filter(d => d.type === 'showcase').sort((a, b) => (a.showcasePosition || 0) - (b.showcasePosition || 0));
      const grid = document.getElementById('showcaseGrid');
      grid.innerHTML = '';

      // Display up to 5 showcase items
      for (let i = 0; i < 5; i++) {
        const item = items[i];
        const showcaseItem = document.createElement('div');
        showcaseItem.className = 'showcase-item';
        
        const width = item?.showcaseWidth || 100;
        const height = item?.showcaseHeight || 300;
        showcaseItem.style.width = width + 'px';
        showcaseItem.style.height = height + 'px';

        if (item && item.showcaseImage) {
          const container = document.createElement('div');
          container.className = 'showcase-image-container';
          
          const img = document.createElement('img');
          img.src = item.showcaseImage;
          img.alt = item.showcaseName || `Showcase ${i + 1}`;
          
          const scale = item.showcaseZoom || 1.0;
          const offsetX = item.showcaseOffsetX || 0;
          const offsetY = item.showcaseOffsetY || 0;
          
          // Use transform scale instead of width percentage
          img.style.width = '100%';
          img.style.height = '100%';
          img.style.objectFit = 'contain';
          img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
          img.style.transformOrigin = 'center center';
          img.style.cursor = editMode ? 'move' : 'default';
          img.style.userSelect = 'none';
          
          if (editMode) {
            let isDragging = false;
            let startX, startY, initialOffsetX, initialOffsetY;
            
            const handleMouseDown = (e) => {
              e.preventDefault();
              e.stopPropagation();
              isDragging = true;
              startX = e.clientX;
              startY = e.clientY;
              initialOffsetX = item.showcaseOffsetX || 0;
              initialOffsetY = item.showcaseOffsetY || 0;
            };
            
            const handleMouseMove = (e) => {
              if (isDragging) {
                e.preventDefault();
                e.stopPropagation();
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                const newOffsetX = initialOffsetX + deltaX;
                const newOffsetY = initialOffsetY + deltaY;
                img.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${scale})`;
              }
            };
            
            const handleMouseUp = async (e) => {
              if (isDragging) {
                e.preventDefault();
                e.stopPropagation();
                isDragging = false;
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                const newOffsetX = initialOffsetX + deltaX;
                const newOffsetY = initialOffsetY + deltaY;
                
                await window.dataSdk.update({
                  ...item,
                  showcaseOffsetX: newOffsetX,
                  showcaseOffsetY: newOffsetY
                });
              }
            };
            
            img.addEventListener('mousedown', handleMouseDown);
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
          }
          
          container.appendChild(img);
          
          showcaseItem.appendChild(container);

          if (editMode) {
            // Move controls
            const moveControls = document.createElement('div');
            moveControls.style.position = 'absolute';
            moveControls.style.top = '10px';
            moveControls.style.left = '10px';
            moveControls.style.display = 'flex';
            moveControls.style.gap = '4px';
            moveControls.style.background = 'rgba(0, 0, 0, 0.8)';
            moveControls.style.padding = '6px';
            moveControls.style.borderRadius = '20px';
            moveControls.style.zIndex = '10';
            
            const moveLeft = document.createElement('button');
            moveLeft.className = 'showcase-btn';
            moveLeft.textContent = '‚Üê';
            moveLeft.onclick = async (e) => {
              e.stopPropagation();
              await moveShowcase(item, 'left');
            };
            
            const moveRight = document.createElement('button');
            moveRight.className = 'showcase-btn';
            moveRight.textContent = '‚Üí';
            moveRight.onclick = async (e) => {
              e.stopPropagation();
              await moveShowcase(item, 'right');
            };
            
            moveControls.appendChild(moveLeft);
            moveControls.appendChild(moveRight);
            showcaseItem.appendChild(moveControls);
            
            const controls = document.createElement('div');
            controls.className = 'showcase-controls';
            
            const sizeBtn = document.createElement('button');
            sizeBtn.className = 'showcase-btn';
            sizeBtn.textContent = 'üìè';
            sizeBtn.onclick = (e) => {
              e.stopPropagation();
              openShowcaseSizeEdit(item, i);
            };
            
            const edit = document.createElement('button');
            edit.className = 'showcase-btn';
            edit.textContent = '‚úèÔ∏è';
            edit.onclick = (e) => {
              e.stopPropagation();
              openForm('showcase', item, i);
            };
            
            const del = document.createElement('button');
            del.className = 'showcase-btn';
            del.textContent = 'üóëÔ∏è';
            del.onclick = async (e) => {
              e.stopPropagation();
              const tempModal = document.createElement('div');
              tempModal.className = 'password-modal show';
              tempModal.innerHTML = `
                <div class="password-box">
                  <div class="password-title">Á¢∫Ë™ç</div>
                  <p style="color: #fff; margin-bottom: 30px;">„Åì„ÅÆ„Ç∑„Éß„ÉºÔøΩÔøΩ„Éº„ÇπÁîªÂÉè„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</p>
                  <div class="password-buttons">
                    <button class="password-btn password-btn-submit" id="confirmDelete">ÂâäÈô§</button>
                    <button class="password-btn password-btn-cancel" id="cancelDelete">„Ç≠„É£„É≥„Çª„É´</button>
                  </div>
                </div>
              `;
              document.body.appendChild(tempModal);
              
              document.getElementById('confirmDelete').onclick = async () => {
                document.body.removeChild(tempModal);
                await window.dataSdk.delete(item);
              };
              
              document.getElementById('cancelDelete').onclick = () => {
                document.body.removeChild(tempModal);
              };
            };
            
            controls.appendChild(edit);
            controls.appendChild(sizeBtn);
            controls.appendChild(del);
            showcaseItem.appendChild(controls);
            
            // Zoom controls
            const zoomControls = document.createElement('div');
            zoomControls.style.position = 'absolute';
            zoomControls.style.bottom = '10px';
            zoomControls.style.left = '50%';
            zoomControls.style.transform = 'translateX(-50%)';
            zoomControls.style.display = 'flex';
            zoomControls.style.gap = '4px';
            zoomControls.style.background = 'rgba(0, 0, 0, 0.8)';
            zoomControls.style.padding = '4px';
            zoomControls.style.borderRadius = '15px';
            zoomControls.style.zIndex = '11';
            
            const zoomIn = document.createElement('button');
            zoomIn.className = 'showcase-btn';
            zoomIn.textContent = '+';
            zoomIn.style.fontSize = '14px';
            zoomIn.onclick = async (e) => {
              e.stopPropagation();
              const currentScale = item.showcaseZoom || 1.0;
              const newScale = currentScale + 0.1;
              const offsetX = item.showcaseOffsetX || 0;
              const offsetY = item.showcaseOffsetY || 0;
              img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
              await window.dataSdk.update({
                ...item,
                showcaseZoom: newScale
              });
            };
            
            const zoomOut = document.createElement('button');
            zoomOut.className = 'showcase-btn';
            zoomOut.textContent = '-';
            zoomOut.style.fontSize = '14px';
            zoomOut.onclick = async (e) => {
              e.stopPropagation();
              const currentScale = item.showcaseZoom || 1.0;
              const newScale = Math.max(currentScale - 0.1, 0.1);
              const offsetX = item.showcaseOffsetX || 0;
              const offsetY = item.showcaseOffsetY || 0;
              img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
              await window.dataSdk.update({
                ...item,
                showcaseZoom: newScale
              });
            };
            
            zoomControls.appendChild(zoomOut);
            zoomControls.appendChild(zoomIn);
            showcaseItem.appendChild(zoomControls);
          }
        } else if (editMode) {
          const addBtn = document.createElement('div');
          addBtn.className = 'showcase-add';
          addBtn.textContent = '+';
          addBtn.style.width = '100%';
          addBtn.style.height = '100%';
          addBtn.onclick = () => openForm('showcase', null, i);
          showcaseItem.appendChild(addBtn);
        }

        grid.appendChild(showcaseItem);
      }
    }

    // Move Cast
    async function moveCast(item, direction) {
      const items = allData.filter(d => d.type === 'cast').sort((a, b) => (a.order || 0) - (b.order || 0));
      const currentIndex = items.findIndex(i => i.__backendId === item.__backendId);
      
      if (currentIndex === -1) return;
      
      const gridColumns = 3;
      const currentRow = Math.floor(currentIndex / gridColumns);
      const currentCol = currentIndex % gridColumns;
      
      let targetIndex = -1;
      
      if (direction === 'up' && currentRow > 0) {
        targetIndex = currentIndex - gridColumns;
      } else if (direction === 'down' && currentIndex + gridColumns < items.length) {
        targetIndex = currentIndex + gridColumns;
      } else if (direction === 'left' && currentCol > 0) {
        targetIndex = currentIndex - 1;
      } else if (direction === 'right' && currentCol < gridColumns - 1 && currentIndex + 1 < items.length) {
        targetIndex = currentIndex + 1;
      }
      
      if (targetIndex === -1 || targetIndex < 0 || targetIndex >= items.length) return;
      
      const targetItem = items[targetIndex];
      const tempOrder = item.order;
      
      await window.dataSdk.update({
        ...item,
        order: targetItem.order
      });
      
      await window.dataSdk.update({
        ...targetItem,
        order: tempOrder
      });
    }

    // Render Cast
    function renderCast() {
      const items = allData.filter(d => d.type === 'cast');
      const grid = document.getElementById('castGrid');
      grid.innerHTML = '';

      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        
        const imageContainer = document.createElement('div');
        imageContainer.className = 'card-image-container';
        
        const innerContainer = document.createElement('div');
        innerContainer.className = 'card-image-container-inner';
        
        const img = document.createElement('img');
        img.className = 'card-image';
        img.src = item.image || 'https://via.placeholder.com/300x350/222/ffd700?text=' + encodeURIComponent(item.name);
        img.alt = item.name;
        img.style.userSelect = 'none';
        
        const scale = item.imageZoom || 1.0;
        const offsetX = item.imageOffsetX || 0;
        const offsetY = item.imageOffsetY || 0;
        
        // Use transform scale for unlimited zoom
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'contain';
        img.style.top = '0';
        img.style.left = '0';
        img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        img.style.transformOrigin = 'center center';
        img.style.cursor = editMode ? 'move' : 'default';
        
        if (editMode) {
          let isDragging = false;
          let startX, startY, initialOffsetX, initialOffsetY;
          
          const handleMouseDown = (e) => {
            e.preventDefault();
            e.stopPropagation();
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            initialOffsetX = item.imageOffsetX || 0;
            initialOffsetY = item.imageOffsetY || 0;
          };
          
          const handleMouseMove = (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              img.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${scale})`;
            }
          };
          
          const handleMouseUp = async (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              isDragging = false;
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              
              await window.dataSdk.update({
                ...item,
                imageOffsetX: newOffsetX,
                imageOffsetY: newOffsetY
              });
            }
          };
          
          img.addEventListener('mousedown', handleMouseDown);
          document.addEventListener('mousemove', handleMouseMove);
          document.addEventListener('mouseup', handleMouseUp);
        }
        
        innerContainer.appendChild(img);
        imageContainer.appendChild(innerContainer);
        card.appendChild(imageContainer);
        
        const body = document.createElement('div');
        body.className = 'card-body';
        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = item.name;
        title.style.whiteSpace = 'pre-wrap';
        
        // Auto-adjust font size based on text length
        setTimeout(() => {
          const containerWidth = title.offsetWidth;
          let fontSize = 28;
          title.style.fontSize = fontSize + 'px';
          title.style.whiteSpace = 'pre';
          
          while (title.scrollWidth > containerWidth && fontSize > 14) {
            fontSize -= 1;
            title.style.fontSize = fontSize + 'px';
          }
          
          // If reached 14px and still overflowing, allow wrapping
          if (fontSize <= 14 && title.scrollWidth > containerWidth) {
            title.style.whiteSpace = 'pre-wrap';
            title.style.wordBreak = 'break-word';
          }
        }, 0);
        
        body.appendChild(title);
        const roleDiv = document.createElement('div');
        roleDiv.className = 'card-text';
        roleDiv.textContent = item.role || '';
        body.appendChild(roleDiv);
        card.appendChild(body);

        if (editMode) {
          // Move controls
          const moveControls = document.createElement('div');
          moveControls.className = 'cast-move-controls';
          
          const moveUp = document.createElement('button');
          moveUp.className = 'cast-move-btn';
          moveUp.textContent = '‚Üë';
          moveUp.style.gridColumn = '2';
          moveUp.style.gridRow = '1';
          moveUp.onclick = async (e) => {
            e.stopPropagation();
            await moveCast(item, 'up');
          };
          
          const moveLeft = document.createElement('button');
          moveLeft.className = 'cast-move-btn';
          moveLeft.textContent = '‚Üê';
          moveLeft.style.gridColumn = '1';
          moveLeft.style.gridRow = '2';
          moveLeft.onclick = async (e) => {
            e.stopPropagation();
            await moveCast(item, 'left');
          };
          
          const moveRight = document.createElement('button');
          moveRight.className = 'cast-move-btn';
          moveRight.textContent = '‚Üí';
          moveRight.style.gridColumn = '3';
          moveRight.style.gridRow = '2';
          moveRight.onclick = async (e) => {
            e.stopPropagation();
            await moveCast(item, 'right');
          };
          
          const moveDown = document.createElement('button');
          moveDown.className = 'cast-move-btn';
          moveDown.textContent = '‚Üì';
          moveDown.style.gridColumn = '2';
          moveDown.style.gridRow = '3';
          moveDown.onclick = async (e) => {
            e.stopPropagation();
            await moveCast(item, 'down');
          };
          
          moveControls.appendChild(moveUp);
          moveControls.appendChild(moveLeft);
          moveControls.appendChild(moveRight);
          moveControls.appendChild(moveDown);
          card.appendChild(moveControls);
          
          const viewBtn = document.createElement('button');
          viewBtn.className = 'edit-btn';
          viewBtn.style.right = '75px';
          viewBtn.textContent = 'üëÅÔ∏è';
          viewBtn.onclick = (e) => {
            e.stopPropagation();
            openCastDetail(item);
          };
          card.appendChild(viewBtn);
          
          const editBtn = document.createElement('button');
          editBtn.className = 'edit-btn';
          editBtn.textContent = '‚úèÔ∏è';
          editBtn.onclick = (e) => {
            e.stopPropagation();
            openForm('cast', item);
          };
          card.appendChild(editBtn);
          
          // Zoom controls
          const zoomControls = document.createElement('div');
          zoomControls.className = 'card-zoom-controls';
          
          const zoomIn = document.createElement('button');
          zoomIn.className = 'card-zoom-btn';
          zoomIn.textContent = '+';
          zoomIn.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.imageZoom || 1.0;
            const newScale = currentScale + 0.1;
            const offsetX = item.imageOffsetX || 0;
            const offsetY = item.imageOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              imageZoom: newScale
            });
          };
          
          const zoomOut = document.createElement('button');
          zoomOut.className = 'card-zoom-btn';
          zoomOut.textContent = '-';
          zoomOut.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.imageZoom || 1.0;
            const newScale = Math.max(currentScale - 0.1, 0.1);
            const offsetX = item.imageOffsetX || 0;
            const offsetY = item.imageOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              imageZoom: newScale
            });
          };
          
          zoomControls.appendChild(zoomOut);
          zoomControls.appendChild(zoomIn);
          card.appendChild(zoomControls);
        }
        
        if (!editMode) {
          card.onclick = () => openCastDetail(item);
        }

        grid.appendChild(card);
      });
    }

    // Open Cast Detail
    function openCastDetail(item) {
      currentCast = item;
      const content = document.getElementById('castDetailContent');
      
      // Create a temporary edit object to store pending changes
      const pendingChanges = {};
      
      // Function to get latest item data
      const getLatestItem = () => allData.find(d => d.__backendId === item.__backendId) || item;
      
      const galleryUrls = item.galleryImages ? item.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
      
      let snsHtml = '<div class="cast-detail-sns">';
      if (item.instagram) {
        snsHtml += `<a href="${item.instagram}" target="_blank" rel="noopener noreferrer" class="sns-icon sns-instagram">üì∑</a>`;
      }
      if (item.tiktok) {
        snsHtml += `<a href="${item.tiktok}" target="_blank" rel="noopener noreferrer" class="sns-icon sns-tiktok">üéµ</a>`;
      }
      if (item.x) {
        snsHtml += `<a href="${item.x}" target="_blank" rel="noopener noreferrer" class="sns-icon sns-x">ùïè</a>`;
      }
      if (item.hoshos) {
        snsHtml += `<a href="${item.hoshos}" target="_blank" rel="noopener noreferrer" class="sns-icon sns-hoshos">H</a>`;
      }
      snsHtml += '</div>';
      
      content.innerHTML = `
        <div class="cast-detail-header">
          <div class="cast-detail-image-container" id="castDetailImageContainer">
            <img src="${item.image || 'https://via.placeholder.com/250x300/222/ffd700?text=' + encodeURIComponent(item.name)}" alt="${item.name}" class="cast-detail-image" id="castDetailImage">
          </div>
          <div class="cast-detail-info">
            <div class="cast-detail-name" id="castDetailName">${item.name}</div>
            <div class="cast-detail-fields-row">
              <div class="cast-detail-field">
                <span class="cast-detail-label">Ë™ïÁîüÊó•:</span>
                <span class="cast-detail-value" id="castDetailBirthday">${item.birthday || 'Êú™Ë®≠ÂÆö'}</span>
              </div>
              <div class="cast-detail-field">
                <span class="cast-detail-label">MBTI:</span>
                <span class="cast-detail-value" id="castDetailMbti">${item.mbti || 'Êú™Ë®≠ÂÆö'}</span>
              </div>
            </div>
            ${snsHtml}
          </div>
        </div>
        ${item.bio ? `<div class="cast-detail-bio">${item.bio}</div>` : ''}
        <div class="cast-detail-gallery">
          <div class="cast-detail-gallery-title">„ÇÆ„É£„É©„É™„Éº</div>
          <div class="gallery-grid" id="galleryGrid"></div>
        </div>
      `;
      
      // Setup detail image zoom
      const detailImg = document.getElementById('castDetailImage');
      const detailContainer = document.getElementById('castDetailImageContainer');
      
      const detailScale = item.detailImageZoom || 1.0;
      const detailOffsetX = item.detailImageOffsetX || 0;
      const detailOffsetY = item.detailImageOffsetY || 0;
      
      detailImg.style.position = 'absolute';
      detailImg.style.top = '0';
      detailImg.style.left = '0';
      detailImg.style.width = '100%';
      detailImg.style.height = '100%';
      detailImg.style.objectFit = 'contain';
      detailImg.style.transform = `translate(${detailOffsetX}px, ${detailOffsetY}px) scale(${detailScale})`;
      detailImg.style.transformOrigin = 'center center';
      detailImg.style.cursor = editMode ? 'move' : 'default';
      
      if (editMode) {
        let isDragging = false;
        let startX, startY, initialOffsetX, initialOffsetY;
        
        const handleMouseDown = (e) => {
          e.preventDefault();
          e.stopPropagation();
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
          const latest = getLatestItem();
          initialOffsetX = latest.detailImageOffsetX || 0;
          initialOffsetY = latest.detailImageOffsetY || 0;
        };
        
        const handleMouseMove = (e) => {
          if (isDragging) {
            e.preventDefault();
            e.stopPropagation();
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            const newOffsetX = initialOffsetX + deltaX;
            const newOffsetY = initialOffsetY + deltaY;
            const latest = getLatestItem();
            const currentScale = latest.detailImageZoom || 1.0;
            detailImg.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${currentScale})`;
          }
        };
        
        const handleMouseUp = async (e) => {
          if (isDragging) {
            e.preventDefault();
            e.stopPropagation();
            isDragging = false;
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            const newOffsetX = initialOffsetX + deltaX;
            const newOffsetY = initialOffsetY + deltaY;
            
            const latestItem = getLatestItem();
            await window.dataSdk.update({
              ...latestItem,
              detailImageOffsetX: newOffsetX,
              detailImageOffsetY: newOffsetY
            });
          }
        };
        
        detailImg.addEventListener('mousedown', handleMouseDown);
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
        
        // Add zoom controls for detail image
        const zoomControls = document.createElement('div');
        zoomControls.style.position = 'absolute';
        zoomControls.style.bottom = '10px';
        zoomControls.style.left = '50%';
        zoomControls.style.transform = 'translateX(-50%)';
        zoomControls.style.display = 'flex';
        zoomControls.style.gap = '4px';
        zoomControls.style.background = 'rgba(0, 0, 0, 0.8)';
        zoomControls.style.padding = '6px';
        zoomControls.style.borderRadius = '20px';
        zoomControls.style.zIndex = '10';
        
        const zoomIn = document.createElement('button');
        zoomIn.className = 'showcase-btn';
        zoomIn.textContent = '+';
        zoomIn.onclick = async (e) => {
          e.stopPropagation();
          const latestItem = getLatestItem();
          const currentScale = latestItem.detailImageZoom || 1.0;
          const newScale = currentScale + 0.1;
          const offsetX = latestItem.detailImageOffsetX || 0;
          const offsetY = latestItem.detailImageOffsetY || 0;
          detailImg.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
          
          await window.dataSdk.update({
            ...latestItem,
            detailImageZoom: newScale
          });
        };
        
        const zoomOut = document.createElement('button');
        zoomOut.className = 'showcase-btn';
        zoomOut.textContent = '-';
        zoomOut.onclick = async (e) => {
          e.stopPropagation();
          const latestItem = getLatestItem();
          const currentScale = latestItem.detailImageZoom || 1.0;
          const newScale = Math.max(currentScale - 0.1, 0.1);
          const offsetX = latestItem.detailImageOffsetX || 0;
          const offsetY = latestItem.detailImageOffsetY || 0;
          detailImg.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
          
          await window.dataSdk.update({
            ...latestItem,
            detailImageZoom: newScale
          });
        };
        
        zoomControls.appendChild(zoomOut);
        zoomControls.appendChild(zoomIn);
        detailContainer.appendChild(zoomControls);
        
        // Function to save all pending changes
        let saveTimeout;
        const savePendingChanges = async () => {
          if (Object.keys(pendingChanges).length > 0) {
            const latestItem = getLatestItem();
            await window.dataSdk.update({
              ...latestItem,
              ...pendingChanges
            });
            // Clear pending changes after save
            Object.keys(pendingChanges).forEach(key => delete pendingChanges[key]);
          }
        };
        
        // Make name editable
        const nameEl = document.getElementById('castDetailName');
        nameEl.contentEditable = true;
        nameEl.style.border = '1px solid rgba(255, 215, 0, 0.3)';
        nameEl.style.padding = '5px';
        nameEl.style.borderRadius = '5px';
        nameEl.addEventListener('input', () => {
          const newName = nameEl.textContent.trim();
          const latest = getLatestItem();
          if (newName && newName !== latest.name) {
            pendingChanges.name = newName;
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(savePendingChanges, 1000);
          }
        });
        
        // Make birthday editable
        const birthdayEl = document.getElementById('castDetailBirthday');
        birthdayEl.innerHTML = `<input type="text" value="${item.birthday || ''}" id="birthdayInput" style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 5px; color: #fff; padding: 5px 10px; font-size: 16px;">`;
        document.getElementById('birthdayInput').addEventListener('input', (e) => {
          const newBirthday = e.target.value.trim();
          const latest = getLatestItem();
          if (newBirthday !== latest.birthday) {
            pendingChanges.birthday = newBirthday;
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(savePendingChanges, 1000);
          }
        });
        
        // Make MBTI editable
        const mbtiEl = document.getElementById('castDetailMbti');
        mbtiEl.innerHTML = `<input type="text" value="${item.mbti || ''}" id="mbtiInput" style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 5px; color: #fff; padding: 5px 10px; font-size: 16px;">`;
        document.getElementById('mbtiInput').addEventListener('input', (e) => {
          const newMbti = e.target.value.trim();
          const latest = getLatestItem();
          if (newMbti !== latest.mbti) {
            pendingChanges.mbti = newMbti;
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(savePendingChanges, 1000);
          }
        });
      }
      
      // Render gallery
      const galleryGrid = document.getElementById('galleryGrid');
      galleryGrid.innerHTML = '';
      
      for (let i = 0; i < galleryUrls.length; i++) {
        const galleryItem = document.createElement('div');
        galleryItem.className = 'gallery-item';
        
        const container = document.createElement('div');
        container.className = 'gallery-item-container';
        
        const img = document.createElement('img');
        img.src = galleryUrls[i];
        img.alt = `Gallery ${i + 1}`;
        img.style.userSelect = 'none';
        
        const galleryKey = `gallery_${i}`;
        const galleryScale = item[`${galleryKey}_zoom`] || 1.0;
        const galleryOffsetX = item[`${galleryKey}_offsetX`] || 0;
        const galleryOffsetY = item[`${galleryKey}_offsetY`] || 0;
        
        img.style.position = 'absolute';
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'contain';
        img.style.top = '0';
        img.style.left = '0';
        img.style.transform = `translate(${galleryOffsetX}px, ${galleryOffsetY}px) scale(${galleryScale})`;
        img.style.transformOrigin = 'center center';
        img.style.cursor = editMode ? 'move' : 'pointer';
        
        if (editMode) {
          let isDragging = false;
          let startX, startY, initialOffsetX, initialOffsetY;
          
          const handleMouseDown = (e) => {
            e.preventDefault();
            e.stopPropagation();
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            const latest = getLatestItem();
            initialOffsetX = latest[`${galleryKey}_offsetX`] || 0;
            initialOffsetY = latest[`${galleryKey}_offsetY`] || 0;
          };
          
          const handleMouseMove = (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              const latest = getLatestItem();
              const currentScale = latest[`${galleryKey}_zoom`] || 1.0;
              img.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${currentScale})`;
            }
          };
          
          const handleMouseUp = async (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              isDragging = false;
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              
              const latestItem = getLatestItem();
              const updateData = { ...latestItem };
              updateData[`${galleryKey}_offsetX`] = newOffsetX;
              updateData[`${galleryKey}_offsetY`] = newOffsetY;
              await window.dataSdk.update(updateData);
            }
          };
          
          img.addEventListener('mousedown', handleMouseDown);
          document.addEventListener('mousemove', handleMouseMove);
          document.addEventListener('mouseup', handleMouseUp);
          
          const controls = document.createElement('div');
          controls.className = 'gallery-controls';
          
          const edit = document.createElement('button');
          edit.className = 'gallery-btn';
          edit.textContent = '‚úèÔ∏è';
          edit.onclick = (e) => {
            e.stopPropagation();
            openGalleryEdit(getLatestItem(), i);
          };
          
          const del = document.createElement('button');
          del.className = 'gallery-btn';
          del.textContent = 'üóëÔ∏è';
          del.onclick = async (e) => {
            e.stopPropagation();
            const latestItem = getLatestItem();
            const urls = latestItem.galleryImages ? latestItem.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
            urls.splice(i, 1);
            await window.dataSdk.update({
              ...latestItem,
              galleryImages: urls.join(',')
            });
          };
          
          controls.appendChild(edit);
          controls.appendChild(del);
          galleryItem.appendChild(controls);
          
          // Zoom controls for gallery
          const zoomControls = document.createElement('div');
          zoomControls.style.position = 'absolute';
          zoomControls.style.bottom = '40px';
          zoomControls.style.left = '50%';
          zoomControls.style.transform = 'translateX(-50%)';
          zoomControls.style.display = 'flex';
          zoomControls.style.gap = '3px';
          zoomControls.style.background = 'rgba(0, 0, 0, 0.8)';
          zoomControls.style.padding = '4px';
          zoomControls.style.borderRadius = '15px';
          zoomControls.style.zIndex = '9';
          
          const zoomIn = document.createElement('button');
          zoomIn.className = 'gallery-btn';
          zoomIn.textContent = '+';
          zoomIn.onclick = async (e) => {
            e.stopPropagation();
            const latestItem = getLatestItem();
            const currentScale = latestItem[`${galleryKey}_zoom`] || 1.0;
            const newScale = currentScale + 0.1;
            const offsetX = latestItem[`${galleryKey}_offsetX`] || 0;
            const offsetY = latestItem[`${galleryKey}_offsetY`] || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            const updateData = { ...latestItem };
            updateData[`${galleryKey}_zoom`] = newScale;
            await window.dataSdk.update(updateData);
          };
          
          const zoomOut = document.createElement('button');
          zoomOut.className = 'gallery-btn';
          zoomOut.textContent = '-';
          zoomOut.onclick = async (e) => {
            e.stopPropagation();
            const latestItem = getLatestItem();
            const currentScale = latestItem[`${galleryKey}_zoom`] || 1.0;
            const newScale = Math.max(currentScale - 0.1, 0.1);
            const offsetX = latestItem[`${galleryKey}_offsetX`] || 0;
            const offsetY = latestItem[`${galleryKey}_offsetY`] || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            const updateData = { ...latestItem };
            updateData[`${galleryKey}_zoom`] = newScale;
            await window.dataSdk.update(updateData);
          };
          
          zoomControls.appendChild(zoomOut);
          zoomControls.appendChild(zoomIn);
          galleryItem.appendChild(zoomControls);
        } else {
          img.onclick = () => openGalleryLightbox(item, i);
        }
        
        container.appendChild(img);
        galleryItem.appendChild(container);
        
        galleryGrid.appendChild(galleryItem);
      }
      
      // Always add "+" button in edit mode
      if (editMode) {
        const addGalleryItem = document.createElement('div');
        addGalleryItem.className = 'gallery-item';
        const addBtn = document.createElement('div');
        addBtn.className = 'gallery-add';
        addBtn.textContent = '+';
        addBtn.onclick = () => openGalleryAdd(getLatestItem());
        addGalleryItem.appendChild(addBtn);
        galleryGrid.appendChild(addGalleryItem);
      }
      
      document.getElementById('castDetail').classList.add('show');
    }

    // Close Cast Detail
    function closeCastDetail() {
      document.getElementById('castDetail').classList.remove('show');
      currentCast = null;
    }

    // Open Gallery Edit
    function openGalleryEdit(item, index) {
      currentCast = item;
      currentGalleryIndex = index;
      
      const galleryUrls = item.galleryImages ? item.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
      
      document.getElementById('formTitle').textContent = '„ÇÆ„É£„É©„É™„ÉºÁîªÂÉè„ÇíÁ∑®ÈõÜ';
      document.getElementById('formFields').innerHTML = `
        <div class="form-group">
          <label class="form-label" for="galleryImageUrl">ÁîªÂÉèURL *</label>
          <input type="url" class="form-input" id="galleryImageUrl" value="${galleryUrls[index] || ''}" required>
        </div>
      `;
      
      currentType = 'gallery-edit';
      document.getElementById('formModal').classList.add('show');
    }

    // Open Gallery Add
    function openGalleryAdd(item) {
      currentCast = item;
      
      document.getElementById('formTitle').textContent = '„ÇÆ„É£„É©„É™„ÉºÁîªÂÉè„ÇíËøΩÂä†';
      document.getElementById('formFields').innerHTML = `
        <div class="form-group">
          <label class="form-label" for="galleryImageUrl">ÁîªÂÉèURL *</label>
          <input type="url" class="form-input" id="galleryImageUrl" required>
        </div>
      `;
      
      currentType = 'gallery-add';
      document.getElementById('formModal').classList.add('show');
    }

    // Open Gallery Lightbox
    function openGalleryLightbox(item, startIndex) {
      const galleryUrls = item.galleryImages ? item.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
      const content = document.getElementById('galleryLightboxContent');
      content.innerHTML = '';
      
      galleryUrls.forEach((url, index) => {
        const img = document.createElement('img');
        img.src = url;
        img.alt = `${item.name} - Gallery ${index + 1}`;
        img.className = 'gallery-lightbox-image';
        content.appendChild(img);
      });
      
      document.getElementById('galleryLightbox').classList.add('show');
      
      // Scroll to the clicked image
      setTimeout(() => {
        const images = content.querySelectorAll('img');
        if (images[startIndex]) {
          images[startIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }, 100);
    }

    // Close Gallery Lightbox
    function closeGalleryLightbox() {
      document.getElementById('galleryLightbox').classList.remove('show');
    }

    // Render News
    function renderNews() {
      const items = allData.filter(d => d.type === 'news');
      const grid = document.getElementById('newsGrid');
      const pagination = document.getElementById('newsPagination');
      const pageInfo = document.getElementById('newsPageInfo');
      const prevBtn = document.getElementById('newsPrev');
      const nextBtn = document.getElementById('newsNext');
      
      grid.innerHTML = '';
      
      const itemsPerPage = 4;
      const startIndex = newsPage * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const pageItems = items.slice(startIndex, endIndex);
      
      pageItems.forEach(item => {
        const card = document.createElement('div');
        card.className = 'square-card';
        
        const inner = document.createElement('div');
        inner.className = 'square-card-inner';
        
        const container = document.createElement('div');
        container.style.position = 'absolute';
        container.style.top = '0';
        container.style.left = '0';
        container.style.width = '100%';
        container.style.height = '100%';
        container.style.overflow = 'hidden';
        
        const img = document.createElement('img');
        img.src = item.newsImage || 'https://via.placeholder.com/400x400/222/ffd700?text=' + encodeURIComponent(item.newsTitle);
        img.alt = item.newsTitle;
        img.style.userSelect = 'none';
        
        const scale = item.newsZoom || 1.0;
        const offsetX = item.newsOffsetX || 0;
        const offsetY = item.newsOffsetY || 0;
        
        img.style.position = 'absolute';
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'contain';
        img.style.top = '0';
        img.style.left = '0';
        img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        img.style.transformOrigin = 'center center';
        img.style.cursor = editMode ? 'move' : 'default';
        
        if (editMode) {
          let isDragging = false;
          let startX, startY, initialOffsetX, initialOffsetY;
          
          const handleMouseDown = (e) => {
            e.preventDefault();
            e.stopPropagation();
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            initialOffsetX = item.newsOffsetX || 0;
            initialOffsetY = item.newsOffsetY || 0;
          };
          
          const handleMouseMove = (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              img.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${scale})`;
            }
          };
          
          const handleMouseUp = async (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              isDragging = false;
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              
              await window.dataSdk.update({
                ...item,
                newsOffsetX: newOffsetX,
                newsOffsetY: newOffsetY
              });
            }
          };
          
          img.addEventListener('mousedown', handleMouseDown);
          document.addEventListener('mousemove', handleMouseMove);
          document.addEventListener('mouseup', handleMouseUp);
        }
        
        container.appendChild(img);
        
        const overlay = document.createElement('div');
        overlay.className = 'card-image-overlay';
        overlay.style.position = 'absolute';
        overlay.style.bottom = '0';
        overlay.style.left = '0';
        overlay.style.right = '0';
        overlay.style.padding = '15px';
        overlay.style.background = 'linear-gradient(to top, rgba(0,0,0,0.9), transparent)';
        
        const dateStr = item.newsDate ? new Date(item.newsDate).toLocaleDateString('ja-JP') : '';
        overlay.innerHTML = `
          ${dateStr ? `<div style="font-size: 11px; color: #ffd700; margin-bottom: 5px; text-align: center;">${dateStr}</div>` : ''}
          <div style="font-size: 16px; font-weight: 700; color: #fff; font-family: 'Oswald', sans-serif; letter-spacing: 1px; text-align: center;">${item.newsTitle}</div>
        `;
        
        inner.appendChild(container);
        inner.appendChild(overlay);
        card.appendChild(inner);

        if (editMode) {
          const editBtn = document.createElement('button');
          editBtn.className = 'edit-btn';
          editBtn.textContent = '‚úèÔ∏è';
          editBtn.onclick = (e) => {
            e.stopPropagation();
            openForm('news', item);
          };
          card.appendChild(editBtn);
          
          // Zoom controls
          const zoomControls = document.createElement('div');
          zoomControls.className = 'card-zoom-controls';
          
          const zoomIn = document.createElement('button');
          zoomIn.className = 'card-zoom-btn';
          zoomIn.textContent = '+';
          zoomIn.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.newsZoom || 1.0;
            const newScale = currentScale + 0.1;
            const offsetX = item.newsOffsetX || 0;
            const offsetY = item.newsOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              newsZoom: newScale
            });
          };
          
          const zoomOut = document.createElement('button');
          zoomOut.className = 'card-zoom-btn';
          zoomOut.textContent = '-';
          zoomOut.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.newsZoom || 1.0;
            const newScale = Math.max(currentScale - 0.1, 0.1);
            const offsetX = item.newsOffsetX || 0;
            const offsetY = item.newsOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              newsZoom: newScale
            });
          };
          
          zoomControls.appendChild(zoomOut);
          zoomControls.appendChild(zoomIn);
          card.appendChild(zoomControls);
        }
        
        if (!editMode) {
          card.onclick = () => openNewsDetail(item);
        }

        grid.appendChild(card);
      });
      
      // Update pagination
      if (items.length > itemsPerPage) {
        pagination.style.display = 'flex';
        const totalPages = Math.ceil(items.length / itemsPerPage);
        pageInfo.textContent = `${newsPage + 1}`;
        prevBtn.disabled = newsPage === 0;
        nextBtn.disabled = (newsPage + 1) >= totalPages;
      } else {
        pagination.style.display = 'none';
      }
    }

    // Open News Detail
    function openNewsDetail(item) {
      const dateStr = item.newsDate ? new Date(item.newsDate).toLocaleDateString('ja-JP') : '';
      
      document.getElementById('formTitle').textContent = item.newsTitle;
      document.getElementById('formFields').innerHTML = `
        ${item.newsImage ? `
          <div style="margin-bottom: 20px; position: relative;">
            <img src="${item.newsImage}" alt="${item.newsTitle}" style="width: 100%; border-radius: 15px; border: 2px solid rgba(255, 215, 0, 0.3);">
            <div style="position: absolute; bottom: 0; left: 0; right: 0; padding: 20px; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); border-radius: 0 0 15px 15px;">
              <div style="font-size: 12px; color: #ffd700; margin-bottom: 5px;">${dateStr}</div>
            </div>
          </div>
        ` : `
          <div style="margin-bottom: 20px;">
            <div style="font-size: 12px; color: #ffd700; margin-bottom: 10px;">${dateStr}</div>
          </div>
        `}
        <div style="line-height: 1.8; white-space: pre-wrap;">${item.newsContent}</div>
      `;
      
      document.getElementById('formButtons').style.display = 'none';
      document.getElementById('formModal').classList.add('show');
    }

    // Render Album
    function renderAlbum() {
      const items = allData.filter(d => d.type === 'album');
      const grid = document.getElementById('albumGrid');
      const pagination = document.getElementById('albumPagination');
      const pageInfo = document.getElementById('albumPageInfo');
      const prevBtn = document.getElementById('albumPrev');
      const nextBtn = document.getElementById('albumNext');
      
      grid.innerHTML = '';
      
      const itemsPerPage = 4;
      const startIndex = albumPage * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const pageItems = items.slice(startIndex, endIndex);

      pageItems.forEach(item => {
        const card = document.createElement('div');
        card.className = 'square-card';
        
        const inner = document.createElement('div');
        inner.className = 'square-card-inner';
        
        const container = document.createElement('div');
        container.style.position = 'absolute';
        container.style.top = '0';
        container.style.left = '0';
        container.style.width = '100%';
        container.style.height = '100%';
        container.style.overflow = 'hidden';
        
        const img = document.createElement('img');
        img.src = item.albumCover || 'https://via.placeholder.com/400x400/222/ffd700?text=' + encodeURIComponent(item.albumTitle);
        img.alt = item.albumTitle;
        img.style.userSelect = 'none';
        
        const scale = item.albumZoom || 1.0;
        const offsetX = item.albumOffsetX || 0;
        const offsetY = item.albumOffsetY || 0;
        
        img.style.position = 'absolute';
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'contain';
        img.style.top = '0';
        img.style.left = '0';
        img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        img.style.transformOrigin = 'center center';
        img.style.cursor = editMode ? 'move' : 'default';
        
        if (editMode) {
          let isDragging = false;
          let startX, startY, initialOffsetX, initialOffsetY;
          
          const handleMouseDown = (e) => {
            e.preventDefault();
            e.stopPropagation();
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            initialOffsetX = item.albumOffsetX || 0;
            initialOffsetY = item.albumOffsetY || 0;
          };
          
          const handleMouseMove = (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              img.style.transform = `translate(${newOffsetX}px, ${newOffsetY}px) scale(${scale})`;
            }
          };
          
          const handleMouseUp = async (e) => {
            if (isDragging) {
              e.preventDefault();
              e.stopPropagation();
              isDragging = false;
              const deltaX = e.clientX - startX;
              const deltaY = e.clientY - startY;
              const newOffsetX = initialOffsetX + deltaX;
              const newOffsetY = initialOffsetY + deltaY;
              
              await window.dataSdk.update({
                ...item,
                albumOffsetX: newOffsetX,
                albumOffsetY: newOffsetY
              });
            }
          };
          
          img.addEventListener('mousedown', handleMouseDown);
          document.addEventListener('mousemove', handleMouseMove);
          document.addEventListener('mouseup', handleMouseUp);
        }
        
        container.appendChild(img);
        
        const overlay = document.createElement('div');
        overlay.className = 'card-image-overlay';
        overlay.style.position = 'absolute';
        overlay.style.bottom = '0';
        overlay.style.left = '0';
        overlay.style.right = '0';
        overlay.style.padding = '15px';
        overlay.style.background = 'linear-gradient(to top, rgba(0,0,0,0.9), transparent)';
        overlay.innerHTML = `<div style="font-size: 18px; font-weight: 700; color: #fff; font-family: 'Oswald', sans-serif; letter-spacing: 1px; text-align: center;">${item.albumTitle}</div>`;
        
        inner.appendChild(container);
        inner.appendChild(overlay);
        card.appendChild(inner);

        if (editMode) {
          const editBtn = document.createElement('button');
          editBtn.className = 'edit-btn';
          editBtn.textContent = '‚úèÔ∏è';
          editBtn.onclick = (e) => {
            e.stopPropagation();
            openForm('album', item);
          };
          card.appendChild(editBtn);
          
          // Zoom controls
          const zoomControls = document.createElement('div');
          zoomControls.className = 'card-zoom-controls';
          
          const zoomIn = document.createElement('button');
          zoomIn.className = 'card-zoom-btn';
          zoomIn.textContent = '+';
          zoomIn.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.albumZoom || 1.0;
            const newScale = currentScale + 0.1;
            const offsetX = item.albumOffsetX || 0;
            const offsetY = item.albumOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              albumZoom: newScale
            });
          };
          
          const zoomOut = document.createElement('button');
          zoomOut.className = 'card-zoom-btn';
          zoomOut.textContent = '-';
          zoomOut.onclick = async (e) => {
            e.stopPropagation();
            const currentScale = item.albumZoom || 1.0;
            const newScale = Math.max(currentScale - 0.1, 0.1);
            const offsetX = item.albumOffsetX || 0;
            const offsetY = item.albumOffsetY || 0;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${newScale})`;
            await window.dataSdk.update({
              ...item,
              albumZoom: newScale
            });
          };
          
          zoomControls.appendChild(zoomOut);
          zoomControls.appendChild(zoomIn);
          card.appendChild(zoomControls);
        }
        
        if (!editMode) {
          card.onclick = () => openAlbumLightbox(item);
        }

        grid.appendChild(card);
      });
      
      // Update pagination
      if (items.length > itemsPerPage) {
        pagination.style.display = 'flex';
        const totalPages = Math.ceil(items.length / itemsPerPage);
        pageInfo.textContent = `${albumPage + 1}`;
        prevBtn.disabled = albumPage === 0;
        nextBtn.disabled = (albumPage + 1) >= totalPages;
      } else {
        pagination.style.display = 'none';
      }
    }

    // Open Album Lightbox
    function openAlbumLightbox(item) {
      const albumUrls = item.albumImages ? item.albumImages.split(',').map(s => s.trim()).filter(s => s) : [];
      const content = document.getElementById('galleryLightboxContent');
      content.innerHTML = '';
      
      if (albumUrls.length === 0) {
        const message = document.createElement('div');
        message.style.color = '#ffd700';
        message.style.textAlign = 'center';
        message.style.padding = '40px';
        message.style.fontSize = '18px';
        message.textContent = '„Åì„ÅÆ„Ç¢„É´„Éê„É†„Å´ÁîªÂÉè„Åå„ÅÇ„Çä„Åæ„Åõ„Çì';
        content.appendChild(message);
      } else {
        albumUrls.forEach((url, index) => {
          const img = document.createElement('img');
          img.src = url;
          img.alt = `${item.albumTitle} - ${index + 1}`;
          img.className = 'gallery-lightbox-image';
          content.appendChild(img);
        });
      }
      
      document.getElementById('galleryLightbox').classList.add('show');
    }

    // Render Store
    function renderStore() {
      const items = allData.filter(d => d.type === 'store');
      const addressItem = allData.find(d => d.type === 'address');
      const content = document.getElementById('storeContent');
      content.innerHTML = '';
      
      // Address section
      const addressSection = document.createElement('div');
      addressSection.className = 'address-section';
      
      const addressContent = document.createElement('div');
      addressContent.className = 'address-content';
      
      const addressText = document.createElement('div');
      addressText.className = 'address-text';
      addressText.innerHTML = `<strong>üìç Â†¥ÊâÄ:</strong><br>${addressItem?.address || 'Êú≠ÂπåÔøΩÔøΩÔøΩ‰∏≠Â§ÆÂå∫Âçó5Êù°Ë•ø6‰∏ÅÁõÆÁ¨¨3„Ç®„Éà„ÉØ„Éº„É´„Éì„É´5Èöé'}`;
      
      const mapLink = document.createElement('a');
      mapLink.href = addressItem?.mapUrl || 'https://maps.google.com/maps/place//data=!4m2!3m1!1s0x5f0b2915d0c28421:0xc4b8101e63215a13?entry=s&sa=X&ved=2ahUKEwju7Yykl6yRAxUAlFYBHdyHBysQ4kB6BAgVEAA&hl=ja';
      mapLink.target = '_blank';
      mapLink.rel = 'noopener noreferrer';
      mapLink.className = 'map-btn';
      mapLink.textContent = 'üó∫Ô∏è Google„Éû„ÉÉ„Éó„ÅßË¶ã„Çã';
      
      addressContent.appendChild(addressText);
      addressContent.appendChild(mapLink);
      addressSection.appendChild(addressContent);
      
      if (editMode) {
        const editBtn = document.createElement('button');
        editBtn.className = 'info-edit-btn';
        editBtn.style.position = 'absolute';
        editBtn.style.top = '20px';
        editBtn.style.right = '20px';
        editBtn.textContent = '‚úèÔ∏è';
        editBtn.onclick = () => openAddressEdit(addressItem);
        addressSection.appendChild(editBtn);
      }
      
      content.appendChild(addressSection);
      
      // SNS section
      const snsSection = document.createElement('div');
      snsSection.className = 'sns-section';
      snsSection.innerHTML = `
        <div class="sns-section-title">SNS„Éª„É™„É≥ÔøΩÔøΩ</div>
        <div class="sns-buttons">
          <a href="https://www.instagram.com/club_f.k?igsh=MWZteThkajVycW1kdQ==" target="_blank" rel="noopener noreferrer" class="sns-link-btn sns-instagram-btn">üì∑ Instagram</a>
          <a href="https://www.host2.jp/shop/fk/index_sp.html" target="_blank" rel="noopener noreferrer" class="sns-link-btn sns-hoshos-btn">„Éõ„Çπ„Éõ„Çπ</a>
        </div>
      `;
      content.appendChild(snsSection);
      
      // Store info sections
      if (items.length === 0 && !editMode) {
        const demoSection = document.createElement('div');
        demoSection.className = 'info-section';
        demoSection.innerHTML = `
          <div class="info-section-header">
            <div class="info-section-title">Âñ∂Ê•≠ÊôÇÈñì</div>
          </div>
          <div class="info-section-content">20:00 - LAST</div>
        `;
        content.appendChild(demoSection);
        
        const demoSection2 = document.createElement('div');
        demoSection2.className = 'info-section';
        demoSection2.innerHTML = `
          <div class="info-section-header">
            <div class="info-section-title">ÈõªË©±Áï™Âè∑</div>
          </div>
          <div class="info-section-content"><a href="tel:0115225943" style="color: #ffd700; text-decoration: none;">011-522-5943</a></div>
        `;
        content.appendChild(demoSection2);
      } else {
        items.forEach(item => {
          const section = document.createElement('div');
          section.className = 'info-section';
          section.innerHTML = `
            <div class="info-section-header">
              <div class="info-section-title">${item.storeTitle}</div>
              ${editMode ? `<button class="info-edit-btn" onclick="openForm('store', ${JSON.stringify(item).replace(/"/g, '&quot;')})">‚úèÔ∏è</button>` : ''}
            </div>
            <div class="info-section-content">${item.storeContent}</div>
          `;
          content.appendChild(section);
        });
      }
    }

    // Open Address Edit
    function openAddressEdit(item) {
      currentType = 'address';
      currentEdit = item;
      
      document.getElementById('formTitle').textContent = '‰ΩèÊâÄ„ÉªÂú∞Âõ≥„ÇíÁ∑®ÈõÜ';
      document.getElementById('formFields').innerHTML = `
        <div class="form-group">
          <label class="form-label" for="address">‰ΩèÊâÄ *</label>
          <input type="text" class="form-input" id="address" value="${item?.address || 'Êú≠ÂπåÔøΩÔøΩ‰∏≠Â§ÆÂå∫Âçó5Êù°Ë•ø6‰∏ÅÁõÆÁ¨¨3„Ç®„Éà„ÉØ„Éº„É´„Éì„É´5Èöé'}" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="mapUrl">Google„Éû„ÉÉ„ÉóURL *</label>
          <input type="url" class="form-input" id="mapUrl" value="${item?.mapUrl || 'https://maps.google.com/maps/place//data=!4m2!3m1!1s0x5f0b2915d0c28421:0xc4b8101e63215a13?entry=s&sa=X&ved=2ahUKEwju7Yykl6yRAxUAlFYBHdyHBysQ4kB6BAgVEAA&hl=ja'}" required>
        </div>
      `;
      
      document.getElementById('formButtons').innerHTML = `
        <button type="submit" class="form-btn form-btn-submit" id="submitBtn">‰øùÂ≠ò</button>
        <button type="button" class="form-btn form-btn-cancel" onclick="closeModal()">„Ç≠„É£„É≥„Çª„É´</button>
      `;
      document.getElementById('formButtons').style.display = 'flex';
      
      document.getElementById('formModal').classList.add('show');
    }

    // Render Price
    function renderPrice() {
      const items = allData.filter(d => d.type === 'price');
      const content = document.getElementById('priceContent');
      content.innerHTML = '';
      
      if (items.length === 0 && !editMode) {
        const demoSection = document.createElement('div');
        demoSection.className = 'info-section';
        demoSection.innerHTML = `
          <div class="info-section-header">
            <div class="info-section-title">„Çª„ÉÉ„ÉàÊñôÈáë</div>
          </div>
          <div class="info-section-content">60ÂàÜ ¬•3,000\nÂª∂Èï∑30ÂàÜ ¬•1,500</div>
        `;
        content.appendChild(demoSection);
        
        const demoSection2 = document.createElement('div');
        demoSection2.className = 'info-section';
        demoSection2.innerHTML = `
          <div class="info-section-header">
            <div class="info-section-title">ÊåáÂêçÊñôÈáë</div>
          </div>
          <div class="info-section-content">ÊåáÂêçÊñô ¬•1,000\nÔøΩÔøΩÔøΩÂÜÖÊåáÂêç ¬•500</div>
        `;
        content.appendChild(demoSection2);
      } else {
        items.forEach(item => {
          const section = document.createElement('div');
          section.className = 'info-section';
          section.innerHTML = `
            <div class="info-section-header">
              <div class="info-section-title">${item.priceTitle}</div>
              ${editMode ? `<button class="info-edit-btn" onclick="openForm('price', ${JSON.stringify(item).replace(/"/g, '&quot;')})">‚úèÔ∏è</button>` : ''}
            </div>
            <div class="info-section-content">${item.priceContent}</div>
          `;
          content.appendChild(section);
        });
      }
    }

    // Render Recruit
    function renderRecruit() {
      const items = allData.filter(d => d.type === 'recruit');
      const content = document.getElementById('recruitContent');
      content.innerHTML = '';
      
      // Recruit detail link
      const linkSection = document.createElement('div');
      linkSection.className = 'recruit-link-section';
      linkSection.innerHTML = `
        <a href="https://www.host2.jp/shop/fk/recruit_sp.html" target="_blank" rel="noopener noreferrer" class="recruit-detail-btn">üìã Ê±Ç‰∫∫Ë©≥Á¥∞„ÇíË¶ã„Çã</a>
      `;
      content.appendChild(linkSection);
      
      // Contact buttons
      const contactSection = document.createElement('div');
      contactSection.className = 'recruit-contact';
      contactSection.innerHTML = `
        <a href="https://line.me/ti/p/ogayou1648" target="_blank" rel="noopener noreferrer" class="contact-btn contact-line">üí¨ LINE„ÅßÂøúÂãü</a>
        <a href="tel:08032339498" class="contact-btn contact-tel">üìû ÈõªË©±„ÅßÂøúÂãü</a>
      `;
      content.appendChild(contactSection);
      
      if (items.length === 0 && !editMode) {
        const demoSection = document.createElement('div');
        demoSection.className = 'info-section';
        demoSection.innerHTML = `
          <div class="info-section-header">
            <div class="info-section-title">ÂãüÈõÜÂÜÖÂÆπ</div>
          </div>
          <div class="info-section-content">„Éõ„Çπ„Éà„Çπ„Çø„ÉÉ„ÉïÂãüÈõÜ‰∏≠ÔºÅ\nÊú™ÁµåÈ®ìËÄÖÔøΩÔøΩÊ≠ìËøé\nË©≥Á¥∞„ÅØ„ÅäÂïè„ÅÑÂêà„Çè„Åõ„Åè„Å†„Åï„ÅÑ</div>
        `;
        content.appendChild(demoSection);
      } else {
        items.forEach(item => {
          const section = document.createElement('div');
          section.className = 'info-section';
          section.innerHTML = `
            <div class="info-section-header">
              <div class="info-section-title">${item.recruitTitle}</div>
              ${editMode ? `<button class="info-edit-btn" onclick="openForm('recruit', ${JSON.stringify(item).replace(/"/g, '&quot;')})">‚úèÔ∏è</button>` : ''}
            </div>
            <div class="info-section-content">${item.recruitContent}</div>
          `;
          content.appendChild(section);
        });
      }
    }

    // Open Form
    function openForm(type, item = null, position = null) {
      currentType = type;
      currentEdit = item;
      currentShowcaseIndex = position;
      
      const titles = {
        cast: item ? '„Ç≠„É£„Çπ„Éà„ÇíÁ∑®ÈõÜ' : 'ÔøΩÔøΩÔøΩ„É£„Çπ„Éà„ÇíËøΩÂä†',
        news: item ? '„Éã„É•„Éº„Çπ„ÇíÁ∑®ÈõÜ' : '„Éã„É•„Éº„Çπ„ÇíËøΩÂä†',
        album: item ? '„Ç¢„É´„Éê„É†„ÇíÁ∑®ÈõÜ' : '„Ç¢„É´„Éê„É†„ÇíËøΩÂä†',
        showcase: item ? '„Ç∑„Éß„Éº„Ç±„Éº„Çπ„ÇíÁ∑®ÈõÜ' : '„Ç∑„Éß„Éº„Ç±„Éº„Çπ„ÇíËøΩÂä†',
        store: item ? 'Â∫óËàóÊÉÖÂ†±„ÇíÁ∑®ÈõÜ' : 'Â∫óËàóÊÉÖÂ†±„ÇíËøΩÂä†',
        price: item ? 'ÊñôÈáëÊÉÖÂ†±„ÇíÁ∑®ÈõÜ' : 'ÊñôÈáëÊÉÖÂ†±„ÇíËøΩÂä†',
        recruit: item ? 'Ê±Ç‰∫∫ÊÉÖÂ†±„ÇíÁ∑®ÈõÜ' : 'Ê±Ç‰∫∫ÊÉÖÂ†±„ÇíËøΩÔøΩÔøΩÔøΩ'
      };
      
      document.getElementById('formTitle').textContent = titles[type];
      
      const fields = document.getElementById('formFields');
      fields.innerHTML = '';

      if (type === 'showcase') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="showcaseName">ÂêçÂâç *</label>
            <textarea class="form-input" id="showcaseName" style="min-height: 60px; resize: vertical;" required>${item?.showcaseName || ''}</textarea>
          </div>
          <div class="form-group">
            <label class="form-label" for="showcaseImage">ÁîªÂÉèURL *</label>
            <input type="url" class="form-input" id="showcaseImage" value="${item?.showcaseImage || ''}" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="showcaseWidth">ÂπÖ (px)</label>
              <input type="number" class="form-input" id="showcaseWidth" value="${item?.showcaseWidth || 100}" min="50" max="200">
            </div>
            <div class="form-group">
              <label class="form-label" for="showcaseHeight">È´òÔøΩÔøΩÔøΩ (px)</label>
              <input type="number" class="form-input" id="showcaseHeight" value="${item?.showcaseHeight || 300}" min="200" max="500">
            </div>
          </div>
        `;
      } else if (type === 'cast') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="name">ÂêçÂâç *</label>
            <input type="text" class="form-input" id="name" value="${item?.name || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="role">ÂΩπËÅ∑</label>
            <input type="text" class="form-input" id="role" value="${item?.role || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="birthday">Ë™ïÁîüÊó•</label>
            <input type="text" class="form-input" id="birthday" value="${item?.birthday || ''}" placeholder="‰æã: 1Êúà1Êó•">
          </div>
          <div class="form-group">
            <label class="form-label" for="mbti">MBTI</label>
            <input type="text" class="form-input" id="mbti" value="${item?.mbti || ''}" placeholder="‰æã: ENFP">
          </div>
          <div class="form-group">
            <label class="form-label" for="bio">Ëá™Â∑±Á¥π‰ªã</label>
            <textarea class="form-textarea" id="bio">${item?.bio || ''}</textarea>
          </div>
          <div class="form-group">
            <label class="form-label" for="image">„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉèURL</label>
            <input type="url" class="form-input" id="image" value="${item?.image || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="instagram">Instagram URL</label>
            <input type="url" class="form-input" id="instagram" value="${item?.instagram || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="tiktok">TikTok URL</label>
            <input type="url" class="form-input" id="tiktok" value="${item?.tiktok || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="x">X URL</label>
            <input type="url" class="form-input" id="x" value="${item?.x || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="hoshos">„Éõ„Çπ„Éõ„Çπ URL</label>
            <input type="url" class="form-input" id="hoshos" value="${item?.hoshos || ''}">
          </div>
        `;
      } else if (type === 'news') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="newsTitle">„Çø„Ç§„Éà„É´ *</label>
            <input type="text" class="form-input" id="newsTitle" value="${item?.newsTitle || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="newsContent">ÂÜÖÂÆπ *</label>
            <textarea class="form-textarea" id="newsContent" required>${item?.newsContent || ''}</textarea>
          </div>
          <div class="form-group">
            <label class="form-label" for="newsImage">ÁîªÂÉèURL</label>
            <input type="url" class="form-input" id="newsImage" value="${item?.newsImage || ''}">
          </div>
        `;
      } else if (type === 'album') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="albumTitle">„Çø„Ç§„Éà„É´ *</label>
            <input type="text" class="form-input" id="albumTitle" value="${item?.albumTitle || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="albumCover">„Ç´„Éê„ÉºÁîªÂÉèURL</label>
            <input type="url" class="form-input" id="albumCover" value="${item?.albumCover || ''}">
          </div>
          <div class="form-group">
            <label class="form-label" for="albumImages">„Ç¢„É´„Éê„É†ÁîªÂÉèURLsÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ*</label>
            <textarea class="form-textarea" id="albumImages" required>${item?.albumImages || ''}</textarea>
          </div>
        `;
      } else if (type === 'store') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="storeTitle">„Çø„Ç§„Éà„É´ *</label>
            <input type="text" class="form-input" id="storeTitle" value="${item?.storeTitle || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="storeContent">ÂÜÖÂÆπ *</label>
            <textarea class="form-textarea" id="storeContent" required>${item?.storeContent || ''}</textarea>
          </div>
        `;
      } else if (type === 'price') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="priceTitle">„Çø„Ç§„Éà„É´ *</label>
            <input type="text" class="form-input" id="priceTitle" value="${item?.priceTitle || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="priceContent">ÂÜÖÂÆπ *</label>
            <textarea class="form-textarea" id="priceContent" required>${item?.priceContent || ''}</textarea>
          </div>
        `;
      } else if (type === 'recruit') {
        fields.innerHTML = `
          <div class="form-group">
            <label class="form-label" for="recruitTitle">„Çø„Ç§„Éà„É´ *</label>
            <input type="text" class="form-input" id="recruitTitle" value="${item?.recruitTitle || ''}" required>
          </div>
          <div class="form-group">
            <label class="form-label" for="recruitContent">ÂÜÖÂÆπ *</label>
            <textarea class="form-textarea" id="recruitContent" required>${item?.recruitContent || ''}</textarea>
          </div>
        `;
      }

      const buttonsHtml = item && item.__backendId ? `
        <button type="submit" class="form-btn form-btn-submit" id="submitBtn">‰øùÂ≠ò</button>
        <button type="button" class="form-btn form-btn-delete" onclick="handleDelete()">ÂâäÔøΩÔøΩÔøΩ</button>
        <button type="button" class="form-btn form-btn-cancel" onclick="closeModal()">„Ç≠„É£„É≥„Çª„É´</button>
      ` : `
        <button type="submit" class="form-btn form-btn-submit" id="submitBtn">‰øùÂ≠ò</button>
        <button type="button" class="form-btn form-btn-cancel" onclick="closeModal()">„Ç≠„É£„É≥„Çª„É´</button>
      `;
      
      document.getElementById('formButtons').innerHTML = buttonsHtml;
      document.getElementById('formButtons').style.display = 'flex';
      document.getElementById('formModal').classList.add('show');
    }

    // Close Modal
    function closeModal() {
      document.getElementById('formModal').classList.remove('show');
      document.getElementById('formButtons').style.display = 'flex';
      currentEdit = null;
      currentType = null;
      currentCast = null;
      currentGalleryIndex = null;
      currentShowcaseIndex = null;
    }

    // Handle Delete
    async function handleDelete() {
      if (!currentEdit || !currentEdit.__backendId) return;
      
      const confirmMessage = 'Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü';
      const tempModal = document.createElement('div');
      tempModal.className = 'password-modal show';
      tempModal.innerHTML = `
        <div class="password-box">
          <div class="password-title">Á¢∫Ë™ç</div>
          <p style="color: #fff; margin-bottom: 30px;">${confirmMessage}</p>
          <div class="password-buttons">
            <button class="password-btn password-btn-submit" id="confirmDelete">ÂâäÈô§</button>
            <button class="password-btn password-btn-cancel" id="cancelDelete">„Ç≠„É£„É≥„Çª„É´</button>
          </div>
        </div>
      `;
      document.body.appendChild(tempModal);
      
      document.getElementById('confirmDelete').onclick = async () => {
        document.body.removeChild(tempModal);
        const result = await window.dataSdk.delete(currentEdit);
        if (result.isOk) {
          closeModal();
          showToast('ÂâäÈô§„Åó„Åæ„Åó„Åü');
        } else {
          showToast('„Ç®„É©„ÉºÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ„Åó„Åæ„Åó„Åü');
        }
      };
      
      document.getElementById('cancelDelete').onclick = () => {
        document.body.removeChild(tempModal);
      };
    }

    // Handle Submit
    async function handleSubmit(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = '‰øùÂ≠ò‰∏≠...';

      let data = { type: currentType };

      if (currentType === 'showcase') {
        data = {
          ...data,
          showcaseName: document.getElementById('showcaseName').value.trim(),
          showcaseImage: document.getElementById('showcaseImage').value,
          showcaseWidth: parseInt(document.getElementById('showcaseWidth').value) || 100,
          showcaseHeight: parseInt(document.getElementById('showcaseHeight').value) || 300,
          showcasePosition: currentEdit ? currentEdit.showcasePosition : (currentShowcaseIndex !== null ? currentShowcaseIndex : allData.filter(d => d.type === 'showcase').length),
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'showcase').length
        };
      } else if (currentType === 'cast') {
        data = {
          ...data,
          name: document.getElementById('name').value,
          role: document.getElementById('role').value,
          birthday: document.getElementById('birthday').value,
          mbti: document.getElementById('mbti').value,
          bio: document.getElementById('bio').value,
          image: document.getElementById('image').value,
          instagram: document.getElementById('instagram').value,
          tiktok: document.getElementById('tiktok').value,
          x: document.getElementById('x').value,
          hoshos: document.getElementById('hoshos').value,
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'cast').length
        };
      } else if (currentType === 'news') {
        data = {
          ...data,
          newsTitle: document.getElementById('newsTitle').value,
          newsContent: document.getElementById('newsContent').value,
          newsImage: document.getElementById('newsImage').value,
          newsDate: currentEdit?.newsDate || new Date().toISOString(),
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'news').length
        };
      } else if (currentType === 'album') {
        data = {
          ...data,
          albumTitle: document.getElementById('albumTitle').value,
          albumCover: document.getElementById('albumCover').value,
          albumImages: document.getElementById('albumImages').value,
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'album').length
        };
      } else if (currentType === 'store') {
        data = {
          ...data,
          storeTitle: document.getElementById('storeTitle').value,
          storeContent: document.getElementById('storeContent').value,
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'store').length
        };
      } else if (currentType === 'price') {
        data = {
          ...data,
          priceTitle: document.getElementById('priceTitle').value,
          priceContent: document.getElementById('priceContent').value,
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'price').length
        };
      } else if (currentType === 'recruit') {
        data = {
          ...data,
          recruitTitle: document.getElementById('recruitTitle').value,
          recruitContent: document.getElementById('recruitContent').value,
          order: currentEdit ? currentEdit.order : allData.filter(d => d.type === 'recruit').length
        };
      } else if (currentType === 'address') {
        data = {
          type: 'address',
          address: document.getElementById('address').value,
          mapUrl: document.getElementById('mapUrl').value,
          order: currentEdit ? currentEdit.order : 0
        };
      } else if (currentType === 'gallery-edit') {
        const galleryUrls = currentCast.galleryImages ? currentCast.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
        
        galleryUrls[currentGalleryIndex] = document.getElementById('galleryImageUrl').value;
        
        const result = await window.dataSdk.update({
          ...currentCast,
          galleryImages: galleryUrls.join(',')
        });
        
        submitBtn.disabled = false;
        submitBtn.textContent = '‰øùÂ≠ò';
        closeModal();
        
        if (result.isOk) {
          // Find updated cast data
          const updatedCast = allData.find(d => d.__backendId === currentCast.__backendId);
          openCastDetail(updatedCast || currentCast);
          showToast('Êõ¥Êñ∞„Åó„Åæ„Åó„Åü');
        }
        return;
      } else if (currentType === 'gallery-add') {
        const galleryUrls = currentCast.galleryImages ? currentCast.galleryImages.split(',').map(s => s.trim()).filter(s => s) : [];
        galleryUrls.push(document.getElementById('galleryImageUrl').value);
        
        const result = await window.dataSdk.update({
          ...currentCast,
          galleryImages: galleryUrls.join(',')
        });
        
        submitBtn.disabled = false;
        submitBtn.textContent = '‰øùÂ≠ò';
        closeModal();
        
        if (result.isOk) {
          // Find updated cast data
          const updatedCast = allData.find(d => d.__backendId === currentCast.__backendId);
          openCastDetail(updatedCast || currentCast);
          showToast('ËøΩÂä†„Åó„Åæ„Åó„Åü');
        }
        return;
      }

      let result;
      if (currentEdit && currentEdit.__backendId) {
        result = await window.dataSdk.update({ ...currentEdit, ...data });
      } else {
        if (allData.length >= 999) {
          showToast('„ÉáÔøΩÔøΩÔøΩÔøΩÔøΩ„ÇøÊï∞„Åå‰∏äÈôêÔºà999Ôºâ„Å´ÈÅî„Åó„Åæ„Åó„Åü');
          submitBtn.disabled = false;
          submitBtn.textContent = '‰øùÂ≠ò';
          return;
        }
        result = await window.dataSdk.create(data);
      }

      submitBtn.disabled = false;
      submitBtn.textContent = '‰øùÂ≠ò';

      if (result.isOk) {
        closeModal();
        showToast(currentEdit && currentEdit.__backendId ? 'Êõ¥Êñ∞„Åó„Åæ„Åó„Åü' : 'ËøΩÂä†„Åó„Åæ„Åó„Åü');
      } else {
        showToast('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');
      }
    }

    // Scroll To Section
    function scrollToSection(id) {
      closeMenu();
      setTimeout(() => {
        const element = document.getElementById(id);
        if (element) {
          element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }, 300);
    }

    // Show Toast
    function showToast(message) {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2500);
    }

    // Initialize
    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9acefc38643bbea7',t:'MTc2NTU2MTAwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>